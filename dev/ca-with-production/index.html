<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model with CA and Production · CarboKitten</title><meta name="title" content="Model with CA and Production · CarboKitten"/><meta property="og:title" content="Model with CA and Production · CarboKitten"/><meta property="twitter:title" content="Model with CA and Production · CarboKitten"/><meta name="description" content="Documentation for CarboKitten."/><meta property="og:description" content="Documentation for CarboKitten."/><meta property="twitter:description" content="Documentation for CarboKitten."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="CarboKitten logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CarboKitten</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../bosscher-1992/">Bosscher and Schlager 1992</a></li><li class="is-active"><a class="tocitem" href>Model with CA and Production</a><ul class="internal"><li><a class="tocitem" href="#Complete-example"><span>Complete example</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../model-alcap/">ALCAPS</a></li><li><a class="tocitem" href="../models/without-ca/">Model without CA</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../first_tutorial/">Tutorial (Pluto notebook)</a></li><li><a class="tocitem" href="../cases/tabular-sea-level/">Tabular Sea Levels</a></li></ul></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><span class="tocitem">Model Components</span><ul><li><a class="tocitem" href="../components/components/">Components</a></li><li><a class="tocitem" href="../components/tag/">Tags</a></li><li><a class="tocitem" href="../components/boxes/">Boxes</a></li><li><a class="tocitem" href="../components/time/">Time</a></li><li><a class="tocitem" href="../components/output/">Output</a></li><li><a class="tocitem" href="../components/facies/">Facies</a></li><li><a class="tocitem" href="../components/cellular-automata/">Cellular Automata</a></li><li><a class="tocitem" href="../components/waterdepth/">Water Depth</a></li><li><a class="tocitem" href="../components/production/">Production</a></li><li><a class="tocitem" href="../components/sediment_buffer/">Sediment Buffers</a></li><li><a class="tocitem" href="../active-layer-transport/">Active Layer Transport</a></li><li><a class="tocitem" href="../onshore-transport/">Onshore Transport</a></li></ul></li><li><a class="tocitem" href="../visualization/">Visualizations</a></li><li><span class="tocitem">CarboCAT</span><ul><li><a class="tocitem" href="../carbocat/">Summary</a></li></ul></li><li><span class="tocitem">Denudation</span><ul><li><a class="tocitem" href="../denudation/denudation/">Denudation</a></li><li><a class="tocitem" href="../denudation/empirical/">Empirical Denudation</a></li><li><a class="tocitem" href="../denudation/chemical/">Chemical Dissolution</a></li><li><a class="tocitem" href="../denudation/physical_erosion/">Physical Erosion</a></li></ul></li><li><span class="tocitem">Input &amp; Output</span><ul><li><a class="tocitem" href="../input-methods/">Input Methods</a></li><li><a class="tocitem" href="../output/abstract/">Output</a></li><li><a class="tocitem" href="../output/h5writer/">HDF5 Output</a></li><li><a class="tocitem" href="../output/memory-writer/">Output to Memory</a></li><li><a class="tocitem" href="../data-export/">CSV Export</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../unitful/">Unitful</a></li><li><a class="tocitem" href="../boxes/">Boxes</a></li><li><a class="tocitem" href="../stencils/">Stencils</a></li><li><a class="tocitem" href="../utility/">Utility</a></li><li><a class="tocitem" href="../finite-difference-transport/">Finite Difference</a></li></ul></li><li><a class="tocitem" href="../api/">API Documentation</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Model with CA and Production</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model with CA and Production</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl/blob/main/docs/transpiled/ca-with-production.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CA-with-production"><a class="docs-heading-anchor" href="#CA-with-production">CA with production</a><a id="CA-with-production-1"></a><a class="docs-heading-anchor-permalink" href="#CA-with-production" title="Permalink"></a></h1><p>This model combines BS92 production with the B13 cellular automaton. This production model is implemented in the <a href="../components/production/"><code>CAProduction</code> component</a>.</p><p><img src="../fig/cap1-summary.png" alt="Stratigraphy, production and subsidence under oscillating sea level."/></p><h2 id="Complete-example"><a class="docs-heading-anchor" href="#Complete-example">Complete example</a><a id="Complete-example-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-example" title="Permalink"></a></h2><p>This example is running for 10000 steps to 1Myr on a 100 <span>$\times$</span> 50 grid, starting with a sloped height down to 50m. The <code>sea_level</code>, and <code>initial_depth</code> arguments are functions. The <code>phys_scale</code> argument translate pixels on the grid into physical metres. The <code>write_interval</code> indicates to write output every 10 iterations, summing the production over that range.</p><div class="noweb-label">file:<i>examples/model/cap/run.jl</i></div><pre><code class="language- julia hljs">#| creates: data/output/cap1.h5
#| requires: src/Models/CAP.jl

module Script

using CarboKitten

const PERIOD = 200.0u&quot;kyr&quot;
const AMPLITUDE = 4.0u&quot;m&quot;

const FACIES = [
	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 500u&quot;m/Myr&quot;,
        extinction_coefficient = 0.8u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;),

	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 400u&quot;m/Myr&quot;,
        extinction_coefficient = 0.1u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;),

	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 100u&quot;m/Myr&quot;,
        extinction_coefficient = 0.005u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;)
	]

	const INPUT = CAP.Input(
		tag = &quot;cap1&quot;,
		box = Box{Coast}(grid_size=(100, 50), phys_scale=150.0u&quot;m&quot;),
		time = TimeProperties(
			Δt = 200.0u&quot;yr&quot;,
			steps = 5000),

        output = Dict(
            :topography =&gt; OutputSpec(write_interval = 500),
            :profile =&gt; OutputSpec(slice = (:, 25))),

		sea_level = t -&gt; 4.0u&quot;m&quot; * sin(2π * t / 0.2u&quot;Myr&quot;),
		initial_topography = (x, y) -&gt; - x / 300.0,
		subsidence_rate = 50.0u&quot;m/Myr&quot;,
		insolation = 400.0u&quot;W/m^2&quot;,
		facies = FACIES)

	main() = run_model(Model{CAP}, INPUT, &quot;data/output/cap1.h5&quot;)
end

Script.main()</code></pre><p>This writes output to an HDF5 file that you may use for further analysis and visualization.</p><div class="noweb-label">file:<i>examples/model/cap/plot.jl</i></div><pre><code class="language- julia hljs">#| creates: docs/src/_fig/cap1-summary.png
#| requires: data/output/cap1.h5
#| collect: figures
using GLMakie
using CarboKitten.Visualization

GLMakie.activate!()

save(&quot;docs/src/_fig/cap1-summary.png&quot;, summary_plot(&quot;data/output/cap1.h5&quot;))</code></pre><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><div class="component-dag" style="overflow: scroll"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Pages: 1 -->
<svg width="745pt" height="580pt"
 viewBox="0.00 0.00 745.00 580.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 576)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-576 741,-576 741,4 -4,4"/>
<!-- TimeIntegration -->
<g id="node1" class="node">
<title>TimeIntegration</title>
<path fill="none" stroke="black" d="M210,-572C210,-572 72,-572 72,-572 66,-572 60,-566 60,-560 60,-560 60,-505 60,-505 60,-499 66,-493 72,-493 72,-493 210,-493 210,-493 216,-493 222,-499 222,-505 222,-505 222,-560 222,-560 222,-566 216,-572 210,-572"/>
<polyline fill="none" stroke="black" points="67,-541.5 215,-541.5 "/>
<text text-anchor="start" x="75.5" y="-550.3" font-family="Times,serif" font-weight="bold" font-size="14.00">TimeIntegration</text>
<polygon fill="#cccccc" stroke="transparent" points="67,-518.5 67,-541.5 114,-541.5 114,-518.5 67,-518.5"/>
<polyline fill="none" stroke="black" points="67,-518.5 114,-518.5 114,-541.5 67,-541.5 "/>
<text text-anchor="start" x="71" y="-526.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="114,-518.5 114,-541.5 168,-541.5 168,-518.5 114,-518.5"/>
<polygon fill="none" stroke="black" points="114,-518.5 114,-541.5 168,-541.5 168,-518.5 114,-518.5"/>
<text text-anchor="start" x="118" y="-526.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="168,-518.5 168,-541.5 215,-541.5 215,-518.5 168,-518.5"/>
<polyline fill="none" stroke="black" points="215,-541.5 168,-541.5 168,-518.5 215,-518.5 "/>
<text text-anchor="start" x="172" y="-526.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="114,-499.5 114,-518.5 "/>
<text text-anchor="start" x="71" y="-506.5" font-family="monospace" font-size="10.00">time</text>
<polyline fill="none" stroke="black" points="168,-499.5 168,-518.5 "/>
<text text-anchor="start" x="118" y="-506.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="171" y="-506.5" font-family="monospace" font-size="10.00">step</text>
</g>
<!-- WaterDepth -->
<g id="node10" class="node">
<title>WaterDepth</title>
<path fill="none" stroke="black" d="M270,-457C270,-457 12,-457 12,-457 6,-457 0,-451 0,-445 0,-445 0,-352 0,-352 0,-346 6,-340 12,-340 12,-340 270,-340 270,-340 276,-340 282,-346 282,-352 282,-352 282,-445 282,-445 282,-451 276,-457 270,-457"/>
<polyline fill="none" stroke="black" points="7,-426.5 275,-426.5 "/>
<text text-anchor="start" x="93.5" y="-435.3" font-family="Times,serif" font-weight="bold" font-size="14.00">WaterDepth</text>
<polygon fill="#cccccc" stroke="transparent" points="7,-403.5 7,-426.5 124,-426.5 124,-403.5 7,-403.5"/>
<polyline fill="none" stroke="black" points="7,-403.5 124,-403.5 124,-426.5 7,-426.5 "/>
<text text-anchor="start" x="11" y="-411.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="124,-403.5 124,-426.5 178,-426.5 178,-403.5 124,-403.5"/>
<polygon fill="none" stroke="black" points="124,-403.5 124,-426.5 178,-426.5 178,-403.5 124,-403.5"/>
<text text-anchor="start" x="128" y="-411.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="178,-403.5 178,-426.5 275,-426.5 275,-403.5 178,-403.5"/>
<polyline fill="none" stroke="black" points="275,-426.5 178,-426.5 178,-403.5 275,-403.5 "/>
<text text-anchor="start" x="182" y="-411.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="124,-384.5 124,-403.5 "/>
<text text-anchor="start" x="11" y="-391.5" font-family="monospace" font-size="10.00">sea_level</text>
<polyline fill="none" stroke="black" points="178,-384.5 178,-403.5 "/>
<text text-anchor="start" x="128" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="181" y="-391.5" font-family="monospace" font-size="10.00">sediment_height</text>
<polyline fill="none" stroke="black" points="124,-365.5 124,-384.5 "/>
<text text-anchor="start" x="11" y="-372.5" font-family="monospace" font-size="10.00">initial_topography</text>
<polyline fill="none" stroke="black" points="178,-365.5 178,-384.5 "/>
<text text-anchor="start" x="128" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="181" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="124,-346.5 124,-365.5 "/>
<text text-anchor="start" x="11" y="-353.5" font-family="monospace" font-size="10.00">subsidence_rate</text>
<polyline fill="none" stroke="black" points="178,-346.5 178,-365.5 "/>
<text text-anchor="start" x="128" y="-353.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="181" y="-353.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- TimeIntegration&#45;&gt;WaterDepth -->
<g id="edge4" class="edge">
<title>TimeIntegration&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M141,-492.97C141,-484.98 141,-476.34 141,-467.65"/>
<polygon fill="black" stroke="black" points="144.5,-467.47 141,-457.47 137.5,-467.47 144.5,-467.47"/>
</g>
<!-- Boxes -->
<g id="node2" class="node">
<title>Boxes</title>
<path fill="none" stroke="black" d="M474,-572C474,-572 336,-572 336,-572 330,-572 324,-566 324,-560 324,-560 324,-505 324,-505 324,-499 330,-493 336,-493 336,-493 474,-493 474,-493 480,-493 486,-499 486,-505 486,-505 486,-560 486,-560 486,-566 480,-572 474,-572"/>
<polyline fill="none" stroke="black" points="331,-541.5 479,-541.5 "/>
<text text-anchor="start" x="381.5" y="-550.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Boxes</text>
<polygon fill="#cccccc" stroke="transparent" points="331,-518.5 331,-541.5 378,-541.5 378,-518.5 331,-518.5"/>
<polyline fill="none" stroke="black" points="331,-518.5 378,-518.5 378,-541.5 331,-541.5 "/>
<text text-anchor="start" x="335" y="-526.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="378,-518.5 378,-541.5 432,-541.5 432,-518.5 378,-518.5"/>
<polygon fill="none" stroke="black" points="378,-518.5 378,-541.5 432,-541.5 432,-518.5 378,-518.5"/>
<text text-anchor="start" x="382" y="-526.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="432,-518.5 432,-541.5 479,-541.5 479,-518.5 432,-518.5"/>
<polyline fill="none" stroke="black" points="479,-541.5 432,-541.5 432,-518.5 479,-518.5 "/>
<text text-anchor="start" x="436" y="-526.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="378,-499.5 378,-518.5 "/>
<text text-anchor="start" x="335" y="-506.5" font-family="monospace" font-size="10.00">box</text>
<polyline fill="none" stroke="black" points="432,-499.5 432,-518.5 "/>
<text text-anchor="start" x="382" y="-506.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="435" y="-506.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- CellularAutomaton -->
<g id="node7" class="node">
<title>CellularAutomaton</title>
<path fill="none" stroke="black" d="M593.5,-294.5C593.5,-294.5 332.5,-294.5 332.5,-294.5 326.5,-294.5 320.5,-288.5 320.5,-282.5 320.5,-282.5 320.5,-208.5 320.5,-208.5 320.5,-202.5 326.5,-196.5 332.5,-196.5 332.5,-196.5 593.5,-196.5 593.5,-196.5 599.5,-196.5 605.5,-202.5 605.5,-208.5 605.5,-208.5 605.5,-282.5 605.5,-282.5 605.5,-288.5 599.5,-294.5 593.5,-294.5"/>
<polyline fill="none" stroke="black" points="328,-264.5 599,-264.5 "/>
<text text-anchor="start" x="388" y="-273.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CellularAutomaton</text>
<polygon fill="#cccccc" stroke="transparent" points="328,-241.5 328,-264.5 421,-264.5 421,-241.5 328,-241.5"/>
<polyline fill="none" stroke="black" points="328,-241.5 421,-241.5 421,-264.5 328,-264.5 "/>
<text text-anchor="start" x="332" y="-249.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="421,-241.5 421,-264.5 526,-264.5 526,-241.5 421,-241.5"/>
<polygon fill="none" stroke="black" points="421,-241.5 421,-264.5 526,-264.5 526,-241.5 421,-241.5"/>
<text text-anchor="start" x="425" y="-249.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="526,-241.5 526,-264.5 599,-264.5 599,-241.5 526,-241.5"/>
<polyline fill="none" stroke="black" points="599,-264.5 526,-264.5 526,-241.5 599,-241.5 "/>
<text text-anchor="start" x="530" y="-249.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="421,-222.5 421,-241.5 "/>
<text text-anchor="start" x="332" y="-229.5" font-family="monospace" font-size="10.00">ca_interval</text>
<polyline fill="none" stroke="black" points="526,-222.5 526,-241.5 "/>
<text text-anchor="start" x="425" y="-229.5" font-family="monospace" font-size="10.00">viability_range</text>
<text text-anchor="start" x="529" y="-229.5" font-family="monospace" font-size="10.00">ca</text>
<polyline fill="none" stroke="black" points="421,-203.5 421,-222.5 "/>
<text text-anchor="start" x="332" y="-210.5" font-family="monospace" font-size="10.00">ca_random_seed</text>
<polyline fill="none" stroke="black" points="526,-203.5 526,-222.5 "/>
<text text-anchor="start" x="425" y="-210.5" font-family="monospace" font-size="10.00">activation_range</text>
<text text-anchor="start" x="529" y="-210.5" font-family="monospace" font-size="10.00">ca_priority</text>
</g>
<!-- Boxes&#45;&gt;CellularAutomaton -->
<g id="edge10" class="edge">
<title>Boxes&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M448.74,-492.61C457.81,-482.05 466.1,-469.93 471,-457 489.59,-407.99 484.85,-347.87 477.09,-304.45"/>
<polygon fill="black" stroke="black" points="480.52,-303.79 475.22,-294.62 473.65,-305.09 480.52,-303.79"/>
</g>
<!-- Boxes&#45;&gt;WaterDepth -->
<g id="edge5" class="edge">
<title>Boxes&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M327.93,-492.97C308.35,-483.18 286.82,-472.41 265.54,-461.77"/>
<polygon fill="black" stroke="black" points="266.95,-458.56 256.44,-457.22 263.82,-464.82 266.95,-458.56"/>
</g>
<!-- CAP -->
<g id="node3" class="node">
<title>CAP</title>
<path fill="none" stroke="black" d="M491,-36C491,-36 461,-36 461,-36 455,-36 449,-30 449,-24 449,-24 449,-12 449,-12 449,-6 455,0 461,0 461,0 491,0 491,0 497,0 503,-6 503,-12 503,-12 503,-24 503,-24 503,-30 497,-36 491,-36"/>
<text text-anchor="start" x="459.5" y="-15.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CAP</text>
</g>
<!-- Tag -->
<g id="node4" class="node">
<title>Tag</title>
<path fill="none" stroke="black" d="M545,-151C545,-151 407,-151 407,-151 401,-151 395,-145 395,-139 395,-139 395,-84 395,-84 395,-78 401,-72 407,-72 407,-72 545,-72 545,-72 551,-72 557,-78 557,-84 557,-84 557,-139 557,-139 557,-145 551,-151 545,-151"/>
<polyline fill="none" stroke="black" points="402,-120.5 550,-120.5 "/>
<text text-anchor="start" x="462" y="-129.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Tag</text>
<polygon fill="#cccccc" stroke="transparent" points="402,-97.5 402,-120.5 449,-120.5 449,-97.5 402,-97.5"/>
<polyline fill="none" stroke="black" points="402,-97.5 449,-97.5 449,-120.5 402,-120.5 "/>
<text text-anchor="start" x="406" y="-105.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="449,-97.5 449,-120.5 503,-120.5 503,-97.5 449,-97.5"/>
<polygon fill="none" stroke="black" points="449,-97.5 449,-120.5 503,-120.5 503,-97.5 449,-97.5"/>
<text text-anchor="start" x="453" y="-105.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="503,-97.5 503,-120.5 550,-120.5 550,-97.5 503,-97.5"/>
<polyline fill="none" stroke="black" points="550,-120.5 503,-120.5 503,-97.5 550,-97.5 "/>
<text text-anchor="start" x="507" y="-105.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="449,-78.5 449,-97.5 "/>
<text text-anchor="start" x="406" y="-85.5" font-family="monospace" font-size="10.00">tag</text>
<polyline fill="none" stroke="black" points="503,-78.5 503,-97.5 "/>
<text text-anchor="start" x="453" y="-85.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="506" y="-85.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Tag&#45;&gt;CAP -->
<g id="edge1" class="edge">
<title>Tag&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M476,-71.96C476,-63.27 476,-54.22 476,-46.11"/>
<polygon fill="black" stroke="black" points="479.5,-46.1 476,-36.1 472.5,-46.1 479.5,-46.1"/>
</g>
<!-- Output -->
<g id="node5" class="node">
<title>Output</title>
<path fill="none" stroke="black" d="M725,-151C725,-151 587,-151 587,-151 581,-151 575,-145 575,-139 575,-139 575,-84 575,-84 575,-78 581,-72 587,-72 587,-72 725,-72 725,-72 731,-72 737,-78 737,-84 737,-84 737,-139 737,-139 737,-145 731,-151 725,-151"/>
<polyline fill="none" stroke="black" points="582,-120.5 730,-120.5 "/>
<text text-anchor="start" x="627.5" y="-129.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Output</text>
<polygon fill="#cccccc" stroke="transparent" points="582,-97.5 582,-120.5 629,-120.5 629,-97.5 582,-97.5"/>
<polyline fill="none" stroke="black" points="582,-97.5 629,-97.5 629,-120.5 582,-120.5 "/>
<text text-anchor="start" x="586" y="-105.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="629,-97.5 629,-120.5 683,-120.5 683,-97.5 629,-97.5"/>
<polygon fill="none" stroke="black" points="629,-97.5 629,-120.5 683,-120.5 683,-97.5 629,-97.5"/>
<text text-anchor="start" x="633" y="-105.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="683,-97.5 683,-120.5 730,-120.5 730,-97.5 683,-97.5"/>
<polyline fill="none" stroke="black" points="730,-120.5 683,-120.5 683,-97.5 730,-97.5 "/>
<text text-anchor="start" x="687" y="-105.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="629,-78.5 629,-97.5 "/>
<text text-anchor="start" x="586" y="-85.5" font-family="monospace" font-size="10.00">output</text>
<polyline fill="none" stroke="black" points="683,-78.5 683,-97.5 "/>
<text text-anchor="start" x="633" y="-85.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="686" y="-85.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Output&#45;&gt;CAP -->
<g id="edge2" class="edge">
<title>Output&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M580.19,-71.96C556.74,-60.04 531.97,-47.45 512.47,-37.54"/>
<polygon fill="black" stroke="black" points="513.85,-34.31 503.35,-32.9 510.68,-40.55 513.85,-34.31"/>
</g>
<!-- CAProduction -->
<g id="node6" class="node">
<title>CAProduction</title>
<path fill="none" stroke="black" d="M364.5,-129.5C364.5,-129.5 265.5,-129.5 265.5,-129.5 259.5,-129.5 253.5,-123.5 253.5,-117.5 253.5,-117.5 253.5,-105.5 253.5,-105.5 253.5,-99.5 259.5,-93.5 265.5,-93.5 265.5,-93.5 364.5,-93.5 364.5,-93.5 370.5,-93.5 376.5,-99.5 376.5,-105.5 376.5,-105.5 376.5,-117.5 376.5,-117.5 376.5,-123.5 370.5,-129.5 364.5,-129.5"/>
<text text-anchor="start" x="260.5" y="-108.8" font-family="Times,serif" font-weight="bold" font-size="14.00">CAProduction</text>
</g>
<!-- CAProduction&#45;&gt;CAP -->
<g id="edge3" class="edge">
<title>CAProduction&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M345.28,-93.29C372.16,-78.01 411.47,-55.67 439.96,-39.48"/>
<polygon fill="black" stroke="black" points="441.84,-42.44 448.8,-34.46 438.38,-36.36 441.84,-42.44"/>
</g>
<!-- CellularAutomaton&#45;&gt;CAProduction -->
<g id="edge8" class="edge">
<title>CellularAutomaton&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M409.15,-196.47C386.3,-176.09 360.67,-153.23 341.93,-136.52"/>
<polygon fill="black" stroke="black" points="344.14,-133.8 334.35,-129.75 339.48,-139.02 344.14,-133.8"/>
</g>
<!-- FaciesBase -->
<g id="node8" class="node">
<title>FaciesBase</title>
<path fill="none" stroke="black" d="M450,-438C450,-438 312,-438 312,-438 306,-438 300,-432 300,-426 300,-426 300,-371 300,-371 300,-365 306,-359 312,-359 312,-359 450,-359 450,-359 456,-359 462,-365 462,-371 462,-371 462,-426 462,-426 462,-432 456,-438 450,-438"/>
<polyline fill="none" stroke="black" points="307,-407.5 455,-407.5 "/>
<text text-anchor="start" x="337" y="-416.3" font-family="Times,serif" font-weight="bold" font-size="14.00">FaciesBase</text>
<polygon fill="#cccccc" stroke="transparent" points="307,-384.5 307,-407.5 354,-407.5 354,-384.5 307,-384.5"/>
<polyline fill="none" stroke="black" points="307,-384.5 354,-384.5 354,-407.5 307,-407.5 "/>
<text text-anchor="start" x="311" y="-392.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="354,-384.5 354,-407.5 408,-407.5 408,-384.5 354,-384.5"/>
<polygon fill="none" stroke="black" points="354,-384.5 354,-407.5 408,-407.5 408,-384.5 354,-384.5"/>
<text text-anchor="start" x="358" y="-392.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="408,-384.5 408,-407.5 455,-407.5 455,-384.5 408,-384.5"/>
<polyline fill="none" stroke="black" points="455,-407.5 408,-407.5 408,-384.5 455,-384.5 "/>
<text text-anchor="start" x="412" y="-392.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="354,-365.5 354,-384.5 "/>
<text text-anchor="start" x="311" y="-372.5" font-family="monospace" font-size="10.00">facies</text>
<polyline fill="none" stroke="black" points="408,-365.5 408,-384.5 "/>
<text text-anchor="start" x="358" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="411" y="-372.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;CellularAutomaton -->
<g id="edge11" class="edge">
<title>FaciesBase&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M402.12,-358.61C411.21,-341.87 422.03,-321.95 432,-303.58"/>
<polygon fill="black" stroke="black" points="435.12,-305.17 436.82,-294.71 428.97,-301.83 435.12,-305.17"/>
</g>
<!-- Production -->
<g id="node9" class="node">
<title>Production</title>
<path fill="none" stroke="black" d="M290.5,-304C290.5,-304 43.5,-304 43.5,-304 37.5,-304 31.5,-298 31.5,-292 31.5,-292 31.5,-199 31.5,-199 31.5,-193 37.5,-187 43.5,-187 43.5,-187 290.5,-187 290.5,-187 296.5,-187 302.5,-193 302.5,-199 302.5,-199 302.5,-292 302.5,-292 302.5,-298 296.5,-304 290.5,-304"/>
<polyline fill="none" stroke="black" points="39,-273.5 296,-273.5 "/>
<text text-anchor="start" x="123.5" y="-282.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Production</text>
<polygon fill="#cccccc" stroke="transparent" points="39,-250.5 39,-273.5 108,-273.5 108,-250.5 39,-250.5"/>
<polyline fill="none" stroke="black" points="39,-250.5 108,-250.5 108,-273.5 39,-273.5 "/>
<text text-anchor="start" x="43" y="-258.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="108,-250.5 108,-273.5 249,-273.5 249,-250.5 108,-250.5"/>
<polygon fill="none" stroke="black" points="108,-250.5 108,-273.5 249,-273.5 249,-250.5 108,-250.5"/>
<text text-anchor="start" x="112" y="-258.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="249,-250.5 249,-273.5 296,-273.5 296,-250.5 249,-250.5"/>
<polyline fill="none" stroke="black" points="296,-273.5 249,-273.5 249,-250.5 296,-250.5 "/>
<text text-anchor="start" x="253" y="-258.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="108,-231.5 108,-250.5 "/>
<text text-anchor="start" x="43" y="-238.5" font-family="monospace" font-size="10.00">insolation</text>
<polyline fill="none" stroke="black" points="249,-231.5 249,-250.5 "/>
<text text-anchor="start" x="112" y="-238.5" font-family="monospace" font-size="10.00">maximum_growth_rate</text>
<text text-anchor="start" x="252" y="-238.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="108,-212.5 108,-231.5 "/>
<text text-anchor="start" x="43" y="-219.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="249,-212.5 249,-231.5 "/>
<text text-anchor="start" x="112" y="-219.5" font-family="monospace" font-size="10.00">extinction_coefficient</text>
<text text-anchor="start" x="252" y="-219.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="108,-193.5 108,-212.5 "/>
<text text-anchor="start" x="43" y="-200.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="249,-193.5 249,-212.5 "/>
<text text-anchor="start" x="112" y="-200.5" font-family="monospace" font-size="10.00">saturation_intensity</text>
<text text-anchor="start" x="252" y="-200.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;Production -->
<g id="edge7" class="edge">
<title>FaciesBase&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M326.17,-358.81C305.12,-343.96 280.51,-326.59 257.01,-310.01"/>
<polygon fill="black" stroke="black" points="258.95,-307.1 248.76,-304.19 254.91,-312.82 258.95,-307.1"/>
</g>
<!-- Production&#45;&gt;CAProduction -->
<g id="edge9" class="edge">
<title>Production&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M231.48,-186.99C251.38,-169.24 272.22,-150.66 288.1,-136.49"/>
<polygon fill="black" stroke="black" points="290.79,-138.78 295.92,-129.52 286.13,-133.56 290.79,-138.78"/>
</g>
<!-- WaterDepth&#45;&gt;Production -->
<g id="edge6" class="edge">
<title>WaterDepth&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M150.9,-339.98C152.36,-331.54 153.87,-322.77 155.35,-314.14"/>
<polygon fill="black" stroke="black" points="158.83,-314.56 157.08,-304.11 151.93,-313.37 158.83,-314.56"/>
</g>
</g>
</svg>
</div><div class="noweb-label">file:<i>src/Models/CAP.jl</i></div><pre><code class="language- julia hljs">@compose module CAP
@mixin Tag, Output, CAProduction

using ..Common
using ..CAProduction: production
using ..TimeIntegration
using ..WaterDepth
using ...Output: Frame
using ModuleMixins: @for_each

export Input, Facies

function initial_state(input::Input)
    ca_state = CellularAutomaton.initial_state(input)
    for _ in 1:20
        CellularAutomaton.step!(input)(ca_state)
    end

    sediment_height = zeros(Height, input.box.grid_size...)
    return State(
        step=0, sediment_height=sediment_height,
        ca=ca_state.ca, ca_priority=ca_state.ca_priority)
end

function step!(input::Input)
    τ = production(input)
    step_ca = CellularAutomaton.step!(input)

    function (state::State)
        if mod(state.step, input.ca_interval) == 0
            step_ca(state)
        end

        prod = τ(state)
        Δη = sum(prod; dims=1)[1, :, :]
        state.sediment_height .+= Δη
        state.step += 1

        return Frame(
            production=prod,
            deposition=prod)
    end
end

function write_header(input::AbstractInput, output::AbstractOutput)
    @for_each(P -&gt; P.write_header(input, output), PARENTS)
end
end</code></pre><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bosscher-1992/">« Bosscher and Schlager 1992</a><a class="docs-footer-nextpage" href="../model-alcap/">ALCAPS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Wednesday 24 September 2025 14:59">Wednesday 24 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
