<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model with CA and Production · CarboKitten</title><meta name="title" content="Model with CA and Production · CarboKitten"/><meta property="og:title" content="Model with CA and Production · CarboKitten"/><meta property="twitter:title" content="Model with CA and Production · CarboKitten"/><meta name="description" content="Documentation for CarboKitten."/><meta property="og:description" content="Documentation for CarboKitten."/><meta property="twitter:description" content="Documentation for CarboKitten."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CarboKitten</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../bosscher-1992/">Bosscher and Schlager 1992</a></li><li class="is-active"><a class="tocitem" href>Model with CA and Production</a><ul class="internal"><li><a class="tocitem" href="#Complete-example"><span>Complete example</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../model-alcap/">ALCAPS</a></li><li><a class="tocitem" href="../models/without-ca/">Model without CA</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../first_tutorial/">Tutorial (Pluto notebook)</a></li><li><a class="tocitem" href="../cases/tabular-sea-level/">Tabular Sea Levels</a></li></ul></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><span class="tocitem">Model Components</span><ul><li><a class="tocitem" href="../components/components/">Components</a></li><li><a class="tocitem" href="../components/run_model/">Model Runner</a></li><li><a class="tocitem" href="../components/hdf5/">HDF5 Writer</a></li><li><a class="tocitem" href="../components/tag/">Tags</a></li><li><a class="tocitem" href="../components/boxes/">Boxes</a></li><li><a class="tocitem" href="../components/time/">Time</a></li><li><a class="tocitem" href="../components/facies/">Facies</a></li><li><a class="tocitem" href="../components/cellular-automata/">Cellular Automata</a></li><li><a class="tocitem" href="../components/waterdepth/">Water Depth</a></li><li><a class="tocitem" href="../components/production/">Production</a></li><li><a class="tocitem" href="../components/sediment_buffer/">Sediment Buffers</a></li><li><a class="tocitem" href="../active-layer-transport/">Active Layer Transport</a></li><li><a class="tocitem" href="../onshore-transport/">Onshore Transport</a></li></ul></li><li><a class="tocitem" href="../visualization/">Visualizations</a></li><li><span class="tocitem">CarboCAT</span><ul><li><a class="tocitem" href="../carbocat/">Summary</a></li></ul></li><li><span class="tocitem">Denudation</span><ul><li><a class="tocitem" href="../denudation/denudation/">Denudation</a></li><li><a class="tocitem" href="../denudation/empirical/">Empirical Denudation</a></li><li><a class="tocitem" href="../denudation/chemical/">Chemical Dissolution</a></li><li><a class="tocitem" href="../denudation/physical_erosion/">Physical Erosion</a></li></ul></li><li><span class="tocitem">Input &amp; Output</span><ul><li><a class="tocitem" href="../input-methods/">Input Methods</a></li><li><a class="tocitem" href="../data-export/">CSV Export</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../unitful/">Unitful</a></li><li><a class="tocitem" href="../boxes/">Boxes</a></li><li><a class="tocitem" href="../stencils/">Stencils</a></li><li><a class="tocitem" href="../utility/">Utility</a></li><li><a class="tocitem" href="../finite-difference-transport/">Finite Difference</a></li></ul></li><li><a class="tocitem" href="../api/">API Documentation</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Model with CA and Production</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model with CA and Production</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl/blob/main/docs/transpiled/ca-with-production.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CA-with-production"><a class="docs-heading-anchor" href="#CA-with-production">CA with production</a><a id="CA-with-production-1"></a><a class="docs-heading-anchor-permalink" href="#CA-with-production" title="Permalink"></a></h1><p>This model combines BS92 production with the B13 cellular automaton. This production model is implemented in the <a href="../components/production/"><code>CAProduction</code> component</a>.</p><p><img src="../fig/cap1-summary.png" alt="Stratigraphy, production and subsidence under oscillating sea level."/></p><h2 id="Complete-example"><a class="docs-heading-anchor" href="#Complete-example">Complete example</a><a id="Complete-example-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-example" title="Permalink"></a></h2><p>This example is running for 10000 steps to 1Myr on a 100 <span>$\times$</span> 50 grid, starting with a sloped height down to 50m. The <code>sea_level</code>, and <code>initial_depth</code> arguments are functions. The <code>phys_scale</code> argument translate pixels on the grid into physical metres. The <code>write_interval</code> indicates to write output every 10 iterations, summing the production over that range.</p><div class="noweb-label">file:<i>examples/model/cap/run.jl</i></div><pre><code class="language- julia hljs">#| creates: data/output/cap1.h5
#| requires: src/Models/CAP.jl

module Script

using CarboKitten

const PERIOD = 200.0u&quot;kyr&quot;
const AMPLITUDE = 4.0u&quot;m&quot;

const FACIES = [
	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 500u&quot;m/Myr&quot;,
        extinction_coefficient = 0.8u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;),

	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 400u&quot;m/Myr&quot;,
        extinction_coefficient = 0.1u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;),

	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 100u&quot;m/Myr&quot;,
        extinction_coefficient = 0.005u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;)
	]

	const INPUT = CAP.Input(
		tag = &quot;cap1&quot;,
		box = Box{Coast}(grid_size=(100, 50), phys_scale=150.0u&quot;m&quot;),
		time = TimeProperties(
			Δt = 200.0u&quot;yr&quot;,
			steps = 5000,
			write_interval = 10),
		sea_level = t -&gt; 4.0u&quot;m&quot; * sin(2π * t / 0.2u&quot;Myr&quot;),
		initial_topography = (x, y) -&gt; - x / 300.0,
		subsidence_rate = 50.0u&quot;m/Myr&quot;,
		insolation = 400.0u&quot;W/m^2&quot;,
		facies = FACIES)

	main() = run_model(Model{CAP}, INPUT, &quot;data/output/cap1.h5&quot;)
end

Script.main()</code></pre><p>This writes output to an HDF5 file that you may use for further analysis and visualization.</p><div class="noweb-label">file:<i>examples/model/cap/plot.jl</i></div><pre><code class="language- julia hljs">#| creates: docs/src/_fig/cap1-summary.png
#| requires: data/output/cap1.h5
#| collect: figures
using GLMakie
using CarboKitten.Visualization

GLMakie.activate!()

save(&quot;docs/src/_fig/cap1-summary.png&quot;, summary_plot(&quot;data/output/cap1.h5&quot;))</code></pre><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><div class="component-dag" style="overflow: scroll"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Pages: 1 -->
<svg width="781pt" height="599pt"
 viewBox="0.00 0.00 780.50 599.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 595)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-595 776.5,-595 776.5,4 -4,4"/>
<!-- Boxes -->
<g id="node1" class="node">
<title>Boxes</title>
<path fill="none" stroke="black" d="M541,-591C541,-591 403,-591 403,-591 397,-591 391,-585 391,-579 391,-579 391,-524 391,-524 391,-518 397,-512 403,-512 403,-512 541,-512 541,-512 547,-512 553,-518 553,-524 553,-524 553,-579 553,-579 553,-585 547,-591 541,-591"/>
<polyline fill="none" stroke="black" points="398,-560.5 546,-560.5 "/>
<text text-anchor="start" x="448.5" y="-569.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Boxes</text>
<polygon fill="#cccccc" stroke="transparent" points="398,-537.5 398,-560.5 445,-560.5 445,-537.5 398,-537.5"/>
<polyline fill="none" stroke="black" points="398,-537.5 445,-537.5 445,-560.5 398,-560.5 "/>
<text text-anchor="start" x="402" y="-545.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="445,-537.5 445,-560.5 499,-560.5 499,-537.5 445,-537.5"/>
<polygon fill="none" stroke="black" points="445,-537.5 445,-560.5 499,-560.5 499,-537.5 445,-537.5"/>
<text text-anchor="start" x="449" y="-545.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="499,-537.5 499,-560.5 546,-560.5 546,-537.5 499,-537.5"/>
<polyline fill="none" stroke="black" points="546,-560.5 499,-560.5 499,-537.5 546,-537.5 "/>
<text text-anchor="start" x="503" y="-545.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="445,-518.5 445,-537.5 "/>
<text text-anchor="start" x="402" y="-525.5" font-family="monospace" font-size="10.00">box</text>
<polyline fill="none" stroke="black" points="499,-518.5 499,-537.5 "/>
<text text-anchor="start" x="449" y="-525.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="502" y="-525.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- WaterDepth -->
<g id="node7" class="node">
<title>WaterDepth</title>
<path fill="none" stroke="black" d="M337,-476C337,-476 79,-476 79,-476 73,-476 67,-470 67,-464 67,-464 67,-371 67,-371 67,-365 73,-359 79,-359 79,-359 337,-359 337,-359 343,-359 349,-365 349,-371 349,-371 349,-464 349,-464 349,-470 343,-476 337,-476"/>
<polyline fill="none" stroke="black" points="74,-445.5 342,-445.5 "/>
<text text-anchor="start" x="160.5" y="-454.3" font-family="Times,serif" font-weight="bold" font-size="14.00">WaterDepth</text>
<polygon fill="#cccccc" stroke="transparent" points="74,-422.5 74,-445.5 191,-445.5 191,-422.5 74,-422.5"/>
<polyline fill="none" stroke="black" points="74,-422.5 191,-422.5 191,-445.5 74,-445.5 "/>
<text text-anchor="start" x="78" y="-430.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="191,-422.5 191,-445.5 245,-445.5 245,-422.5 191,-422.5"/>
<polygon fill="none" stroke="black" points="191,-422.5 191,-445.5 245,-445.5 245,-422.5 191,-422.5"/>
<text text-anchor="start" x="195" y="-430.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="245,-422.5 245,-445.5 342,-445.5 342,-422.5 245,-422.5"/>
<polyline fill="none" stroke="black" points="342,-445.5 245,-445.5 245,-422.5 342,-422.5 "/>
<text text-anchor="start" x="249" y="-430.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="191,-403.5 191,-422.5 "/>
<text text-anchor="start" x="78" y="-410.5" font-family="monospace" font-size="10.00">sea_level</text>
<polyline fill="none" stroke="black" points="245,-403.5 245,-422.5 "/>
<text text-anchor="start" x="195" y="-410.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="248" y="-410.5" font-family="monospace" font-size="10.00">sediment_height</text>
<polyline fill="none" stroke="black" points="191,-384.5 191,-403.5 "/>
<text text-anchor="start" x="78" y="-391.5" font-family="monospace" font-size="10.00">initial_topography</text>
<polyline fill="none" stroke="black" points="245,-384.5 245,-403.5 "/>
<text text-anchor="start" x="195" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="248" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="191,-365.5 191,-384.5 "/>
<text text-anchor="start" x="78" y="-372.5" font-family="monospace" font-size="10.00">subsidence_rate</text>
<polyline fill="none" stroke="black" points="245,-365.5 245,-384.5 "/>
<text text-anchor="start" x="195" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="248" y="-372.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Boxes&#45;&gt;WaterDepth -->
<g id="edge5" class="edge">
<title>Boxes&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M394.93,-511.97C375.35,-502.18 353.82,-491.41 332.54,-480.77"/>
<polygon fill="black" stroke="black" points="333.95,-477.56 323.44,-476.22 330.82,-483.82 333.95,-477.56"/>
</g>
<!-- CellularAutomaton -->
<g id="node9" class="node">
<title>CellularAutomaton</title>
<path fill="none" stroke="black" d="M760.5,-304C760.5,-304 499.5,-304 499.5,-304 493.5,-304 487.5,-298 487.5,-292 487.5,-292 487.5,-218 487.5,-218 487.5,-212 493.5,-206 499.5,-206 499.5,-206 760.5,-206 760.5,-206 766.5,-206 772.5,-212 772.5,-218 772.5,-218 772.5,-292 772.5,-292 772.5,-298 766.5,-304 760.5,-304"/>
<polyline fill="none" stroke="black" points="495,-274 766,-274 "/>
<text text-anchor="start" x="555" y="-282.8" font-family="Times,serif" font-weight="bold" font-size="14.00">CellularAutomaton</text>
<polygon fill="#cccccc" stroke="transparent" points="495,-251 495,-274 588,-274 588,-251 495,-251"/>
<polyline fill="none" stroke="black" points="495,-251 588,-251 588,-274 495,-274 "/>
<text text-anchor="start" x="499" y="-258.8" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="588,-251 588,-274 693,-274 693,-251 588,-251"/>
<polygon fill="none" stroke="black" points="588,-251 588,-274 693,-274 693,-251 588,-251"/>
<text text-anchor="start" x="592" y="-258.8" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="693,-251 693,-274 766,-274 766,-251 693,-251"/>
<polyline fill="none" stroke="black" points="766,-274 693,-274 693,-251 766,-251 "/>
<text text-anchor="start" x="697" y="-258.8" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="588,-232 588,-251 "/>
<text text-anchor="start" x="499" y="-239" font-family="monospace" font-size="10.00">ca_interval</text>
<polyline fill="none" stroke="black" points="693,-232 693,-251 "/>
<text text-anchor="start" x="592" y="-239" font-family="monospace" font-size="10.00">viability_range</text>
<text text-anchor="start" x="696" y="-239" font-family="monospace" font-size="10.00">ca</text>
<polyline fill="none" stroke="black" points="588,-213 588,-232 "/>
<text text-anchor="start" x="499" y="-220" font-family="monospace" font-size="10.00">ca_random_seed</text>
<polyline fill="none" stroke="black" points="693,-213 693,-232 "/>
<text text-anchor="start" x="592" y="-220" font-family="monospace" font-size="10.00">activation_range</text>
<text text-anchor="start" x="696" y="-220" font-family="monospace" font-size="10.00">ca_priority</text>
</g>
<!-- Boxes&#45;&gt;CellularAutomaton -->
<g id="edge12" class="edge">
<title>Boxes&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M510.55,-511.84C520.29,-500.83 530.19,-488.44 538,-476 570.36,-424.44 595.9,-359.53 611.78,-313.62"/>
<polygon fill="black" stroke="black" points="615.1,-314.71 615.02,-304.12 608.48,-312.45 615.1,-314.71"/>
</g>
<!-- TimeIntegration -->
<g id="node2" class="node">
<title>TimeIntegration</title>
<path fill="none" stroke="black" d="M277,-591C277,-591 139,-591 139,-591 133,-591 127,-585 127,-579 127,-579 127,-524 127,-524 127,-518 133,-512 139,-512 139,-512 277,-512 277,-512 283,-512 289,-518 289,-524 289,-524 289,-579 289,-579 289,-585 283,-591 277,-591"/>
<polyline fill="none" stroke="black" points="134,-560.5 282,-560.5 "/>
<text text-anchor="start" x="142.5" y="-569.3" font-family="Times,serif" font-weight="bold" font-size="14.00">TimeIntegration</text>
<polygon fill="#cccccc" stroke="transparent" points="134,-537.5 134,-560.5 181,-560.5 181,-537.5 134,-537.5"/>
<polyline fill="none" stroke="black" points="134,-537.5 181,-537.5 181,-560.5 134,-560.5 "/>
<text text-anchor="start" x="138" y="-545.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="181,-537.5 181,-560.5 235,-560.5 235,-537.5 181,-537.5"/>
<polygon fill="none" stroke="black" points="181,-537.5 181,-560.5 235,-560.5 235,-537.5 181,-537.5"/>
<text text-anchor="start" x="185" y="-545.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="235,-537.5 235,-560.5 282,-560.5 282,-537.5 235,-537.5"/>
<polyline fill="none" stroke="black" points="282,-560.5 235,-560.5 235,-537.5 282,-537.5 "/>
<text text-anchor="start" x="239" y="-545.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="181,-518.5 181,-537.5 "/>
<text text-anchor="start" x="138" y="-525.5" font-family="monospace" font-size="10.00">time</text>
<polyline fill="none" stroke="black" points="235,-518.5 235,-537.5 "/>
<text text-anchor="start" x="185" y="-525.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="238" y="-525.5" font-family="monospace" font-size="10.00">step</text>
</g>
<!-- TimeIntegration&#45;&gt;WaterDepth -->
<g id="edge4" class="edge">
<title>TimeIntegration&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M208,-511.97C208,-503.98 208,-495.34 208,-486.65"/>
<polygon fill="black" stroke="black" points="211.5,-486.47 208,-476.47 204.5,-486.47 211.5,-486.47"/>
</g>
<!-- CAP -->
<g id="node3" class="node">
<title>CAP</title>
<path fill="none" stroke="black" d="M205,-36C205,-36 175,-36 175,-36 169,-36 163,-30 163,-24 163,-24 163,-12 163,-12 163,-6 169,0 175,0 175,0 205,0 205,0 211,0 217,-6 217,-12 217,-12 217,-24 217,-24 217,-30 211,-36 205,-36"/>
<text text-anchor="start" x="173.5" y="-15.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CAP</text>
</g>
<!-- Tag -->
<g id="node4" class="node">
<title>Tag</title>
<path fill="none" stroke="black" d="M150,-151C150,-151 12,-151 12,-151 6,-151 0,-145 0,-139 0,-139 0,-84 0,-84 0,-78 6,-72 12,-72 12,-72 150,-72 150,-72 156,-72 162,-78 162,-84 162,-84 162,-139 162,-139 162,-145 156,-151 150,-151"/>
<polyline fill="none" stroke="black" points="7,-120.5 155,-120.5 "/>
<text text-anchor="start" x="67" y="-129.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Tag</text>
<polygon fill="#cccccc" stroke="transparent" points="7,-97.5 7,-120.5 54,-120.5 54,-97.5 7,-97.5"/>
<polyline fill="none" stroke="black" points="7,-97.5 54,-97.5 54,-120.5 7,-120.5 "/>
<text text-anchor="start" x="11" y="-105.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="54,-97.5 54,-120.5 108,-120.5 108,-97.5 54,-97.5"/>
<polygon fill="none" stroke="black" points="54,-97.5 54,-120.5 108,-120.5 108,-97.5 54,-97.5"/>
<text text-anchor="start" x="58" y="-105.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="108,-97.5 108,-120.5 155,-120.5 155,-97.5 108,-97.5"/>
<polyline fill="none" stroke="black" points="155,-120.5 108,-120.5 108,-97.5 155,-97.5 "/>
<text text-anchor="start" x="112" y="-105.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="54,-78.5 54,-97.5 "/>
<text text-anchor="start" x="11" y="-85.5" font-family="monospace" font-size="10.00">tag</text>
<polyline fill="none" stroke="black" points="108,-78.5 108,-97.5 "/>
<text text-anchor="start" x="58" y="-85.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="111" y="-85.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Tag&#45;&gt;CAP -->
<g id="edge1" class="edge">
<title>Tag&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M126.91,-71.96C138.78,-62 151.21,-51.57 161.86,-42.62"/>
<polygon fill="black" stroke="black" points="164.22,-45.21 169.63,-36.1 159.72,-39.85 164.22,-45.21"/>
</g>
<!-- H5Writer -->
<g id="node5" class="node">
<title>H5Writer</title>
<path fill="none" stroke="black" d="M168.5,-273C168.5,-273 103.5,-273 103.5,-273 97.5,-273 91.5,-267 91.5,-261 91.5,-261 91.5,-249 91.5,-249 91.5,-243 97.5,-237 103.5,-237 103.5,-237 168.5,-237 168.5,-237 174.5,-237 180.5,-243 180.5,-249 180.5,-249 180.5,-261 180.5,-261 180.5,-267 174.5,-273 168.5,-273"/>
<text text-anchor="start" x="98.5" y="-252.3" font-family="Times,serif" font-weight="bold" font-size="14.00">H5Writer</text>
</g>
<!-- H5Writer&#45;&gt;CAP -->
<g id="edge2" class="edge">
<title>H5Writer&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M142.94,-236.79C150.84,-216.57 163.6,-181.85 171,-151 179.54,-115.38 184.78,-73.37 187.54,-46.48"/>
<polygon fill="black" stroke="black" points="191.05,-46.57 188.54,-36.28 184.08,-45.89 191.05,-46.57"/>
</g>
<!-- FaciesBase -->
<g id="node6" class="node">
<title>FaciesBase</title>
<path fill="none" stroke="black" d="M517,-457C517,-457 379,-457 379,-457 373,-457 367,-451 367,-445 367,-445 367,-390 367,-390 367,-384 373,-378 379,-378 379,-378 517,-378 517,-378 523,-378 529,-384 529,-390 529,-390 529,-445 529,-445 529,-451 523,-457 517,-457"/>
<polyline fill="none" stroke="black" points="374,-426.5 522,-426.5 "/>
<text text-anchor="start" x="404" y="-435.3" font-family="Times,serif" font-weight="bold" font-size="14.00">FaciesBase</text>
<polygon fill="#cccccc" stroke="transparent" points="374,-403.5 374,-426.5 421,-426.5 421,-403.5 374,-403.5"/>
<polyline fill="none" stroke="black" points="374,-403.5 421,-403.5 421,-426.5 374,-426.5 "/>
<text text-anchor="start" x="378" y="-411.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="421,-403.5 421,-426.5 475,-426.5 475,-403.5 421,-403.5"/>
<polygon fill="none" stroke="black" points="421,-403.5 421,-426.5 475,-426.5 475,-403.5 421,-403.5"/>
<text text-anchor="start" x="425" y="-411.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="475,-403.5 475,-426.5 522,-426.5 522,-403.5 475,-403.5"/>
<polyline fill="none" stroke="black" points="522,-426.5 475,-426.5 475,-403.5 522,-403.5 "/>
<text text-anchor="start" x="479" y="-411.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="421,-384.5 421,-403.5 "/>
<text text-anchor="start" x="378" y="-391.5" font-family="monospace" font-size="10.00">facies</text>
<polyline fill="none" stroke="black" points="475,-384.5 475,-403.5 "/>
<text text-anchor="start" x="425" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="478" y="-391.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;H5Writer -->
<g id="edge6" class="edge">
<title>FaciesBase&#45;&gt;H5Writer</title>
<path fill="none" stroke="black" d="M394.5,-377.94C382.87,-370.83 370.35,-364.07 358,-359 286.95,-329.86 254.24,-363.51 189,-323 172.88,-312.99 159.63,-296.24 150.41,-282"/>
<polygon fill="black" stroke="black" points="153.16,-279.79 144.95,-273.1 147.19,-283.45 153.16,-279.79"/>
</g>
<!-- FaciesBase&#45;&gt;CellularAutomaton -->
<g id="edge13" class="edge">
<title>FaciesBase&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M492.06,-377.65C514.75,-357.64 542.8,-332.9 567.67,-310.97"/>
<polygon fill="black" stroke="black" points="570.09,-313.5 575.28,-304.26 565.46,-308.25 570.09,-313.5"/>
</g>
<!-- Production -->
<g id="node10" class="node">
<title>Production</title>
<path fill="none" stroke="black" d="M457.5,-323C457.5,-323 210.5,-323 210.5,-323 204.5,-323 198.5,-317 198.5,-311 198.5,-311 198.5,-199 198.5,-199 198.5,-193 204.5,-187 210.5,-187 210.5,-187 457.5,-187 457.5,-187 463.5,-187 469.5,-193 469.5,-199 469.5,-199 469.5,-311 469.5,-311 469.5,-317 463.5,-323 457.5,-323"/>
<polyline fill="none" stroke="black" points="206,-293 463,-293 "/>
<text text-anchor="start" x="290.5" y="-301.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Production</text>
<polygon fill="#cccccc" stroke="transparent" points="206,-270 206,-293 275,-293 275,-270 206,-270"/>
<polyline fill="none" stroke="black" points="206,-270 275,-270 275,-293 206,-293 "/>
<text text-anchor="start" x="210" y="-277.8" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="275,-270 275,-293 416,-293 416,-270 275,-270"/>
<polygon fill="none" stroke="black" points="275,-270 275,-293 416,-293 416,-270 275,-270"/>
<text text-anchor="start" x="279" y="-277.8" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="416,-270 416,-293 463,-293 463,-270 416,-270"/>
<polyline fill="none" stroke="black" points="463,-293 416,-293 416,-270 463,-270 "/>
<text text-anchor="start" x="420" y="-277.8" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="275,-251 275,-270 "/>
<text text-anchor="start" x="210" y="-258" font-family="monospace" font-size="10.00">insolation</text>
<polyline fill="none" stroke="black" points="416,-251 416,-270 "/>
<text text-anchor="start" x="279" y="-258" font-family="monospace" font-size="10.00">maximum_growth_rate</text>
<text text-anchor="start" x="419" y="-258" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="275,-232 275,-251 "/>
<text text-anchor="start" x="210" y="-239" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="416,-232 416,-251 "/>
<text text-anchor="start" x="279" y="-239" font-family="monospace" font-size="10.00">extinction_coefficient</text>
<text text-anchor="start" x="419" y="-239" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="275,-213 275,-232 "/>
<text text-anchor="start" x="210" y="-220" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="416,-213 416,-232 "/>
<text text-anchor="start" x="279" y="-220" font-family="monospace" font-size="10.00">saturation_intensity</text>
<text text-anchor="start" x="419" y="-220" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="275,-194 275,-213 "/>
<text text-anchor="start" x="210" y="-201" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="416,-194 416,-213 "/>
<text text-anchor="start" x="279" y="-201" font-family="monospace" font-size="10.00">production_offset</text>
<text text-anchor="start" x="419" y="-201" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;Production -->
<g id="edge9" class="edge">
<title>FaciesBase&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M420.4,-377.65C410.53,-363.74 399.03,-347.56 387.71,-331.61"/>
<polygon fill="black" stroke="black" points="390.45,-329.44 381.81,-323.31 384.75,-333.49 390.45,-329.44"/>
</g>
<!-- WaterDepth&#45;&gt;H5Writer -->
<g id="edge7" class="edge">
<title>WaterDepth&#45;&gt;H5Writer</title>
<path fill="none" stroke="black" d="M182.01,-358.56C170.38,-332.63 157.23,-303.33 147.98,-282.7"/>
<polygon fill="black" stroke="black" points="151.06,-281.02 143.77,-273.33 144.67,-283.89 151.06,-281.02"/>
</g>
<!-- WaterDepth&#45;&gt;Production -->
<g id="edge8" class="edge">
<title>WaterDepth&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M253.49,-358.56C260.47,-349.67 267.76,-340.38 274.98,-331.18"/>
<polygon fill="black" stroke="black" points="277.87,-333.16 281.29,-323.14 272.37,-328.84 277.87,-333.16"/>
</g>
<!-- CAProduction -->
<g id="node8" class="node">
<title>CAProduction</title>
<path fill="none" stroke="black" d="M383.5,-129.5C383.5,-129.5 284.5,-129.5 284.5,-129.5 278.5,-129.5 272.5,-123.5 272.5,-117.5 272.5,-117.5 272.5,-105.5 272.5,-105.5 272.5,-99.5 278.5,-93.5 284.5,-93.5 284.5,-93.5 383.5,-93.5 383.5,-93.5 389.5,-93.5 395.5,-99.5 395.5,-105.5 395.5,-105.5 395.5,-117.5 395.5,-117.5 395.5,-123.5 389.5,-129.5 383.5,-129.5"/>
<text text-anchor="start" x="279.5" y="-108.8" font-family="Times,serif" font-weight="bold" font-size="14.00">CAProduction</text>
</g>
<!-- CAProduction&#45;&gt;CAP -->
<g id="edge3" class="edge">
<title>CAProduction&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M306.91,-93.29C283.89,-78.66 250.65,-57.54 225.49,-41.55"/>
<polygon fill="black" stroke="black" points="227.28,-38.54 216.96,-36.13 223.53,-44.45 227.28,-38.54"/>
</g>
<!-- CellularAutomaton&#45;&gt;CAProduction -->
<g id="edge10" class="edge">
<title>CellularAutomaton&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M529.37,-205.9C478.33,-181.49 418.87,-153.07 379.08,-134.05"/>
<polygon fill="black" stroke="black" points="380.43,-130.82 369.9,-129.66 377.42,-137.13 380.43,-130.82"/>
</g>
<!-- Production&#45;&gt;CAProduction -->
<g id="edge11" class="edge">
<title>Production&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M334,-186.98C334,-170.18 334,-153.11 334,-139.55"/>
<polygon fill="black" stroke="black" points="337.5,-139.5 334,-129.5 330.5,-139.5 337.5,-139.5"/>
</g>
</g>
</svg>
</div><div class="noweb-label">file:<i>src/Models/CAP.jl</i></div><pre><code class="language- julia hljs">@compose module CAP
@mixin Tag, H5Writer, CAProduction

using ..Common
using ..CAProduction: production
using ..TimeIntegration
using ..WaterDepth
using ModuleMixins: @for_each

export Input, Facies

function initial_state(input::Input)
    ca_state = CellularAutomaton.initial_state(input)
    for _ in 1:20
        CellularAutomaton.step!(input)(ca_state)
    end

    sediment_height = zeros(Height, input.box.grid_size...)
    return State(
        step=0, sediment_height=sediment_height,
        ca=ca_state.ca, ca_priority=ca_state.ca_priority)
end

function step!(input::Input)
    τ = production(input)
    step_ca = CellularAutomaton.step!(input)

    function (state::State)
        if mod(state.step, input.ca_interval) == 0
            step_ca(state)
        end

        prod = τ(state)
        Δη = sum(prod; dims=1)[1, :, :]
        state.sediment_height .+= Δη
        state.step += 1

        return Frame(
            production = prod,
            deposition = prod)
    end
end

function write_header(fid, input::AbstractInput)
    @for_each(P -&gt; P.write_header(fid, input), PARENTS)
end
end</code></pre><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bosscher-1992/">« Bosscher and Schlager 1992</a><a class="docs-footer-nextpage" href="../model-alcap/">ALCAPS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Tuesday 20 May 2025 12:19">Tuesday 20 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
