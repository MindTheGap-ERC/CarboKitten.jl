<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model with CA and Production · CarboKitten</title><meta name="title" content="Model with CA and Production · CarboKitten"/><meta property="og:title" content="Model with CA and Production · CarboKitten"/><meta property="twitter:title" content="Model with CA and Production · CarboKitten"/><meta name="description" content="Documentation for CarboKitten."/><meta property="og:description" content="Documentation for CarboKitten."/><meta property="twitter:description" content="Documentation for CarboKitten."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CarboKitten</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../bosscher-1992/">Bosscher and Schlager 1992</a></li><li class="is-active"><a class="tocitem" href>Model with CA and Production</a><ul class="internal"><li><a class="tocitem" href="#Complete-example"><span>Complete example</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../model-alcap/">ALCAPS</a></li><li><a class="tocitem" href="../models/without-ca/">Model without CA</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../first_tutorial/">Tutorial (Pluto notebook)</a></li><li><a class="tocitem" href="../cases/tabular-sea-level/">Tabular Sea Levels</a></li></ul></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><span class="tocitem">Model Components</span><ul><li><a class="tocitem" href="../components/components/">Components</a></li><li><a class="tocitem" href="../components/run_model/">Model Runner</a></li><li><a class="tocitem" href="../components/hdf5/">HDF5 Writer</a></li><li><a class="tocitem" href="../components/tag/">Tags</a></li><li><a class="tocitem" href="../components/boxes/">Boxes</a></li><li><a class="tocitem" href="../components/time/">Time</a></li><li><a class="tocitem" href="../components/facies/">Facies</a></li><li><a class="tocitem" href="../components/cellular-automata/">Cellular Automata</a></li><li><a class="tocitem" href="../components/waterdepth/">Water Depth</a></li><li><a class="tocitem" href="../components/production/">Production</a></li><li><a class="tocitem" href="../components/sediment_buffer/">Sediment Buffers</a></li><li><a class="tocitem" href="../active-layer-transport/">Active Layer Transport</a></li><li><a class="tocitem" href="../onshore-transport/">Onshore Transport</a></li></ul></li><li><a class="tocitem" href="../visualization/">Visualizations</a></li><li><span class="tocitem">CarboCAT</span><ul><li><a class="tocitem" href="../carbocat/">Summary</a></li></ul></li><li><span class="tocitem">Denudation</span><ul><li><a class="tocitem" href="../denudation/denudation/">Denudation</a></li><li><a class="tocitem" href="../denudation/empirical/">Empirical Denudation</a></li><li><a class="tocitem" href="../denudation/chemical/">Chemical Dissolution</a></li><li><a class="tocitem" href="../denudation/physical_erosion/">Physical Erosion</a></li></ul></li><li><span class="tocitem">Input &amp; Output</span><ul><li><a class="tocitem" href="../input-methods/">Input Methods</a></li><li><a class="tocitem" href="../data-export/">CSV Export</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../unitful/">Unitful</a></li><li><a class="tocitem" href="../boxes/">Boxes</a></li><li><a class="tocitem" href="../stencils/">Stencils</a></li><li><a class="tocitem" href="../utility/">Utility</a></li><li><a class="tocitem" href="../finite-difference-transport/">Finite Difference</a></li></ul></li><li><a class="tocitem" href="../api/">API Documentation</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Model with CA and Production</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model with CA and Production</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl/blob/main/docs/transpiled/ca-with-production.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CA-with-production"><a class="docs-heading-anchor" href="#CA-with-production">CA with production</a><a id="CA-with-production-1"></a><a class="docs-heading-anchor-permalink" href="#CA-with-production" title="Permalink"></a></h1><p>This model combines BS92 production with the B13 cellular automaton. This production model is implemented in the <a href="../components/production/"><code>CAProduction</code> component</a>.</p><p><img src="../fig/cap1-summary.png" alt="Stratigraphy, production and subsidence under oscillating sea level."/></p><h2 id="Complete-example"><a class="docs-heading-anchor" href="#Complete-example">Complete example</a><a id="Complete-example-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-example" title="Permalink"></a></h2><p>This example is running for 10000 steps to 1Myr on a 100 <span>$\times$</span> 50 grid, starting with a sloped height down to 50m. The <code>sea_level</code>, and <code>initial_depth</code> arguments are functions. The <code>phys_scale</code> argument translate pixels on the grid into physical metres. The <code>write_interval</code> indicates to write output every 10 iterations, summing the production over that range.</p><div class="noweb-label">file:<i>examples/model/cap/run.jl</i></div><pre><code class="language- julia hljs">#| creates: data/output/cap1.h5
#| requires: src/Models/CAP.jl

module Script

using CarboKitten

const PERIOD = 200.0u&quot;kyr&quot;
const AMPLITUDE = 4.0u&quot;m&quot;

const FACIES = [
	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 500u&quot;m/Myr&quot;,
        extinction_coefficient = 0.8u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;),

	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 400u&quot;m/Myr&quot;,
        extinction_coefficient = 0.1u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;),

	    CAP.Facies(
        viability_range = (4, 10),
        activation_range = (6, 10),
        maximum_growth_rate = 100u&quot;m/Myr&quot;,
        extinction_coefficient = 0.005u&quot;m^-1&quot;,
        saturation_intensity = 60u&quot;W/m^2&quot;)
	]

	const INPUT = CAP.Input(
		tag = &quot;cap1&quot;,
		box = Box{Coast}(grid_size=(100, 50), phys_scale=150.0u&quot;m&quot;),
		time = TimeProperties(
			Δt = 200.0u&quot;yr&quot;,
			steps = 5000),

        output = Dict(
            :topography =&gt; OutputSpec(write_interval = 500),
            :profile =&gt; OutputSpec(slice = (:, 25))),

		sea_level = t -&gt; 4.0u&quot;m&quot; * sin(2π * t / 0.2u&quot;Myr&quot;),
		initial_topography = (x, y) -&gt; - x / 300.0,
		subsidence_rate = 50.0u&quot;m/Myr&quot;,
		insolation = 400.0u&quot;W/m^2&quot;,
		facies = FACIES)

	main() = run_model(Model{CAP}, INPUT, &quot;data/output/cap1.h5&quot;)
end

Script.main()</code></pre><p>This writes output to an HDF5 file that you may use for further analysis and visualization.</p><div class="noweb-label">file:<i>examples/model/cap/plot.jl</i></div><pre><code class="language- julia hljs">#| creates: docs/src/_fig/cap1-summary.png
#| requires: data/output/cap1.h5
#| collect: figures
using GLMakie
using CarboKitten.Visualization

GLMakie.activate!()

save(&quot;docs/src/_fig/cap1-summary.png&quot;, summary_plot(&quot;data/output/cap1.h5&quot;))</code></pre><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><div class="component-dag" style="overflow: scroll"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Pages: 1 -->
<svg width="800pt" height="580pt"
 viewBox="0.00 0.00 799.50 580.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 576)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-576 795.5,-576 795.5,4 -4,4"/>
<!-- Boxes -->
<g id="node1" class="node">
<title>Boxes</title>
<path fill="none" stroke="black" d="M542,-572C542,-572 404,-572 404,-572 398,-572 392,-566 392,-560 392,-560 392,-505 392,-505 392,-499 398,-493 404,-493 404,-493 542,-493 542,-493 548,-493 554,-499 554,-505 554,-505 554,-560 554,-560 554,-566 548,-572 542,-572"/>
<polyline fill="none" stroke="black" points="399,-541.5 547,-541.5 "/>
<text text-anchor="start" x="449.5" y="-550.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Boxes</text>
<polygon fill="#cccccc" stroke="transparent" points="399,-518.5 399,-541.5 446,-541.5 446,-518.5 399,-518.5"/>
<polyline fill="none" stroke="black" points="399,-518.5 446,-518.5 446,-541.5 399,-541.5 "/>
<text text-anchor="start" x="403" y="-526.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="446,-518.5 446,-541.5 500,-541.5 500,-518.5 446,-518.5"/>
<polygon fill="none" stroke="black" points="446,-518.5 446,-541.5 500,-541.5 500,-518.5 446,-518.5"/>
<text text-anchor="start" x="450" y="-526.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="500,-518.5 500,-541.5 547,-541.5 547,-518.5 500,-518.5"/>
<polyline fill="none" stroke="black" points="547,-541.5 500,-541.5 500,-518.5 547,-518.5 "/>
<text text-anchor="start" x="504" y="-526.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="446,-499.5 446,-518.5 "/>
<text text-anchor="start" x="403" y="-506.5" font-family="monospace" font-size="10.00">box</text>
<polyline fill="none" stroke="black" points="500,-499.5 500,-518.5 "/>
<text text-anchor="start" x="450" y="-506.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="503" y="-506.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- WaterDepth -->
<g id="node7" class="node">
<title>WaterDepth</title>
<path fill="none" stroke="black" d="M338,-457C338,-457 80,-457 80,-457 74,-457 68,-451 68,-445 68,-445 68,-352 68,-352 68,-346 74,-340 80,-340 80,-340 338,-340 338,-340 344,-340 350,-346 350,-352 350,-352 350,-445 350,-445 350,-451 344,-457 338,-457"/>
<polyline fill="none" stroke="black" points="75,-426.5 343,-426.5 "/>
<text text-anchor="start" x="161.5" y="-435.3" font-family="Times,serif" font-weight="bold" font-size="14.00">WaterDepth</text>
<polygon fill="#cccccc" stroke="transparent" points="75,-403.5 75,-426.5 192,-426.5 192,-403.5 75,-403.5"/>
<polyline fill="none" stroke="black" points="75,-403.5 192,-403.5 192,-426.5 75,-426.5 "/>
<text text-anchor="start" x="79" y="-411.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="192,-403.5 192,-426.5 246,-426.5 246,-403.5 192,-403.5"/>
<polygon fill="none" stroke="black" points="192,-403.5 192,-426.5 246,-426.5 246,-403.5 192,-403.5"/>
<text text-anchor="start" x="196" y="-411.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="246,-403.5 246,-426.5 343,-426.5 343,-403.5 246,-403.5"/>
<polyline fill="none" stroke="black" points="343,-426.5 246,-426.5 246,-403.5 343,-403.5 "/>
<text text-anchor="start" x="250" y="-411.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="192,-384.5 192,-403.5 "/>
<text text-anchor="start" x="79" y="-391.5" font-family="monospace" font-size="10.00">sea_level</text>
<polyline fill="none" stroke="black" points="246,-384.5 246,-403.5 "/>
<text text-anchor="start" x="196" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="249" y="-391.5" font-family="monospace" font-size="10.00">sediment_height</text>
<polyline fill="none" stroke="black" points="192,-365.5 192,-384.5 "/>
<text text-anchor="start" x="79" y="-372.5" font-family="monospace" font-size="10.00">initial_topography</text>
<polyline fill="none" stroke="black" points="246,-365.5 246,-384.5 "/>
<text text-anchor="start" x="196" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="249" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="192,-346.5 192,-365.5 "/>
<text text-anchor="start" x="79" y="-353.5" font-family="monospace" font-size="10.00">subsidence_rate</text>
<polyline fill="none" stroke="black" points="246,-346.5 246,-365.5 "/>
<text text-anchor="start" x="196" y="-353.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="249" y="-353.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Boxes&#45;&gt;WaterDepth -->
<g id="edge5" class="edge">
<title>Boxes&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M395.93,-492.97C376.35,-483.18 354.82,-472.41 333.54,-461.77"/>
<polygon fill="black" stroke="black" points="334.95,-458.56 324.44,-457.22 331.82,-464.82 334.95,-458.56"/>
</g>
<!-- CellularAutomaton -->
<g id="node9" class="node">
<title>CellularAutomaton</title>
<path fill="none" stroke="black" d="M779.5,-294.5C779.5,-294.5 518.5,-294.5 518.5,-294.5 512.5,-294.5 506.5,-288.5 506.5,-282.5 506.5,-282.5 506.5,-208.5 506.5,-208.5 506.5,-202.5 512.5,-196.5 518.5,-196.5 518.5,-196.5 779.5,-196.5 779.5,-196.5 785.5,-196.5 791.5,-202.5 791.5,-208.5 791.5,-208.5 791.5,-282.5 791.5,-282.5 791.5,-288.5 785.5,-294.5 779.5,-294.5"/>
<polyline fill="none" stroke="black" points="514,-264.5 785,-264.5 "/>
<text text-anchor="start" x="574" y="-273.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CellularAutomaton</text>
<polygon fill="#cccccc" stroke="transparent" points="514,-241.5 514,-264.5 607,-264.5 607,-241.5 514,-241.5"/>
<polyline fill="none" stroke="black" points="514,-241.5 607,-241.5 607,-264.5 514,-264.5 "/>
<text text-anchor="start" x="518" y="-249.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="607,-241.5 607,-264.5 712,-264.5 712,-241.5 607,-241.5"/>
<polygon fill="none" stroke="black" points="607,-241.5 607,-264.5 712,-264.5 712,-241.5 607,-241.5"/>
<text text-anchor="start" x="611" y="-249.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="712,-241.5 712,-264.5 785,-264.5 785,-241.5 712,-241.5"/>
<polyline fill="none" stroke="black" points="785,-264.5 712,-264.5 712,-241.5 785,-241.5 "/>
<text text-anchor="start" x="716" y="-249.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="607,-222.5 607,-241.5 "/>
<text text-anchor="start" x="518" y="-229.5" font-family="monospace" font-size="10.00">ca_interval</text>
<polyline fill="none" stroke="black" points="712,-222.5 712,-241.5 "/>
<text text-anchor="start" x="611" y="-229.5" font-family="monospace" font-size="10.00">viability_range</text>
<text text-anchor="start" x="715" y="-229.5" font-family="monospace" font-size="10.00">ca</text>
<polyline fill="none" stroke="black" points="607,-203.5 607,-222.5 "/>
<text text-anchor="start" x="518" y="-210.5" font-family="monospace" font-size="10.00">ca_random_seed</text>
<polyline fill="none" stroke="black" points="712,-203.5 712,-222.5 "/>
<text text-anchor="start" x="611" y="-210.5" font-family="monospace" font-size="10.00">activation_range</text>
<text text-anchor="start" x="715" y="-210.5" font-family="monospace" font-size="10.00">ca_priority</text>
</g>
<!-- Boxes&#45;&gt;CellularAutomaton -->
<g id="edge12" class="edge">
<title>Boxes&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M510.51,-492.76C520.35,-481.66 530.57,-469.24 539,-457 572.67,-408.12 603.25,-347.66 623.58,-304.1"/>
<polygon fill="black" stroke="black" points="626.86,-305.34 627.88,-294.79 620.51,-302.4 626.86,-305.34"/>
</g>
<!-- TimeIntegration -->
<g id="node2" class="node">
<title>TimeIntegration</title>
<path fill="none" stroke="black" d="M278,-572C278,-572 140,-572 140,-572 134,-572 128,-566 128,-560 128,-560 128,-505 128,-505 128,-499 134,-493 140,-493 140,-493 278,-493 278,-493 284,-493 290,-499 290,-505 290,-505 290,-560 290,-560 290,-566 284,-572 278,-572"/>
<polyline fill="none" stroke="black" points="135,-541.5 283,-541.5 "/>
<text text-anchor="start" x="143.5" y="-550.3" font-family="Times,serif" font-weight="bold" font-size="14.00">TimeIntegration</text>
<polygon fill="#cccccc" stroke="transparent" points="135,-518.5 135,-541.5 182,-541.5 182,-518.5 135,-518.5"/>
<polyline fill="none" stroke="black" points="135,-518.5 182,-518.5 182,-541.5 135,-541.5 "/>
<text text-anchor="start" x="139" y="-526.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="182,-518.5 182,-541.5 236,-541.5 236,-518.5 182,-518.5"/>
<polygon fill="none" stroke="black" points="182,-518.5 182,-541.5 236,-541.5 236,-518.5 182,-518.5"/>
<text text-anchor="start" x="186" y="-526.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="236,-518.5 236,-541.5 283,-541.5 283,-518.5 236,-518.5"/>
<polyline fill="none" stroke="black" points="283,-541.5 236,-541.5 236,-518.5 283,-518.5 "/>
<text text-anchor="start" x="240" y="-526.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="182,-499.5 182,-518.5 "/>
<text text-anchor="start" x="139" y="-506.5" font-family="monospace" font-size="10.00">time</text>
<polyline fill="none" stroke="black" points="236,-499.5 236,-518.5 "/>
<text text-anchor="start" x="186" y="-506.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="239" y="-506.5" font-family="monospace" font-size="10.00">step</text>
</g>
<!-- TimeIntegration&#45;&gt;WaterDepth -->
<g id="edge4" class="edge">
<title>TimeIntegration&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M209,-492.97C209,-484.98 209,-476.34 209,-467.65"/>
<polygon fill="black" stroke="black" points="212.5,-467.47 209,-457.47 205.5,-467.47 212.5,-467.47"/>
</g>
<!-- CAP -->
<g id="node3" class="node">
<title>CAP</title>
<path fill="none" stroke="black" d="M205,-36C205,-36 175,-36 175,-36 169,-36 163,-30 163,-24 163,-24 163,-12 163,-12 163,-6 169,0 175,0 175,0 205,0 205,0 211,0 217,-6 217,-12 217,-12 217,-24 217,-24 217,-30 211,-36 205,-36"/>
<text text-anchor="start" x="173.5" y="-15.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CAP</text>
</g>
<!-- Tag -->
<g id="node4" class="node">
<title>Tag</title>
<path fill="none" stroke="black" d="M150,-151C150,-151 12,-151 12,-151 6,-151 0,-145 0,-139 0,-139 0,-84 0,-84 0,-78 6,-72 12,-72 12,-72 150,-72 150,-72 156,-72 162,-78 162,-84 162,-84 162,-139 162,-139 162,-145 156,-151 150,-151"/>
<polyline fill="none" stroke="black" points="7,-120.5 155,-120.5 "/>
<text text-anchor="start" x="67" y="-129.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Tag</text>
<polygon fill="#cccccc" stroke="transparent" points="7,-97.5 7,-120.5 54,-120.5 54,-97.5 7,-97.5"/>
<polyline fill="none" stroke="black" points="7,-97.5 54,-97.5 54,-120.5 7,-120.5 "/>
<text text-anchor="start" x="11" y="-105.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="54,-97.5 54,-120.5 108,-120.5 108,-97.5 54,-97.5"/>
<polygon fill="none" stroke="black" points="54,-97.5 54,-120.5 108,-120.5 108,-97.5 54,-97.5"/>
<text text-anchor="start" x="58" y="-105.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="108,-97.5 108,-120.5 155,-120.5 155,-97.5 108,-97.5"/>
<polyline fill="none" stroke="black" points="155,-120.5 108,-120.5 108,-97.5 155,-97.5 "/>
<text text-anchor="start" x="112" y="-105.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="54,-78.5 54,-97.5 "/>
<text text-anchor="start" x="11" y="-85.5" font-family="monospace" font-size="10.00">tag</text>
<polyline fill="none" stroke="black" points="108,-78.5 108,-97.5 "/>
<text text-anchor="start" x="58" y="-85.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="111" y="-85.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Tag&#45;&gt;CAP -->
<g id="edge1" class="edge">
<title>Tag&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M126.91,-71.96C138.78,-62 151.21,-51.57 161.86,-42.62"/>
<polygon fill="black" stroke="black" points="164.22,-45.21 169.63,-36.1 159.72,-39.85 164.22,-45.21"/>
</g>
<!-- H5Writer -->
<g id="node5" class="node">
<title>H5Writer</title>
<path fill="none" stroke="black" d="M187,-285C187,-285 49,-285 49,-285 43,-285 37,-279 37,-273 37,-273 37,-218 37,-218 37,-212 43,-206 49,-206 49,-206 187,-206 187,-206 193,-206 199,-212 199,-218 199,-218 199,-273 199,-273 199,-279 193,-285 187,-285"/>
<polyline fill="none" stroke="black" points="44,-254.5 192,-254.5 "/>
<text text-anchor="start" x="80.5" y="-263.3" font-family="Times,serif" font-weight="bold" font-size="14.00">H5Writer</text>
<polygon fill="#cccccc" stroke="transparent" points="44,-231.5 44,-254.5 91,-254.5 91,-231.5 44,-231.5"/>
<polyline fill="none" stroke="black" points="44,-231.5 91,-231.5 91,-254.5 44,-254.5 "/>
<text text-anchor="start" x="48" y="-239.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="91,-231.5 91,-254.5 145,-254.5 145,-231.5 91,-231.5"/>
<polygon fill="none" stroke="black" points="91,-231.5 91,-254.5 145,-254.5 145,-231.5 91,-231.5"/>
<text text-anchor="start" x="95" y="-239.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="145,-231.5 145,-254.5 192,-254.5 192,-231.5 145,-231.5"/>
<polyline fill="none" stroke="black" points="192,-254.5 145,-254.5 145,-231.5 192,-231.5 "/>
<text text-anchor="start" x="149" y="-239.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="91,-212.5 91,-231.5 "/>
<text text-anchor="start" x="48" y="-219.5" font-family="monospace" font-size="10.00">output</text>
<polyline fill="none" stroke="black" points="145,-212.5 145,-231.5 "/>
<text text-anchor="start" x="95" y="-219.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="148" y="-219.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- H5Writer&#45;&gt;CAP -->
<g id="edge2" class="edge">
<title>H5Writer&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M144.4,-205.55C154.22,-189.33 164.54,-169.89 171,-151 182.91,-116.15 187.36,-73.64 189.01,-46.45"/>
<polygon fill="black" stroke="black" points="192.53,-46.31 189.55,-36.14 185.54,-45.94 192.53,-46.31"/>
</g>
<!-- FaciesBase -->
<g id="node6" class="node">
<title>FaciesBase</title>
<path fill="none" stroke="black" d="M518,-438C518,-438 380,-438 380,-438 374,-438 368,-432 368,-426 368,-426 368,-371 368,-371 368,-365 374,-359 380,-359 380,-359 518,-359 518,-359 524,-359 530,-365 530,-371 530,-371 530,-426 530,-426 530,-432 524,-438 518,-438"/>
<polyline fill="none" stroke="black" points="375,-407.5 523,-407.5 "/>
<text text-anchor="start" x="405" y="-416.3" font-family="Times,serif" font-weight="bold" font-size="14.00">FaciesBase</text>
<polygon fill="#cccccc" stroke="transparent" points="375,-384.5 375,-407.5 422,-407.5 422,-384.5 375,-384.5"/>
<polyline fill="none" stroke="black" points="375,-384.5 422,-384.5 422,-407.5 375,-407.5 "/>
<text text-anchor="start" x="379" y="-392.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="422,-384.5 422,-407.5 476,-407.5 476,-384.5 422,-384.5"/>
<polygon fill="none" stroke="black" points="422,-384.5 422,-407.5 476,-407.5 476,-384.5 422,-384.5"/>
<text text-anchor="start" x="426" y="-392.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="476,-384.5 476,-407.5 523,-407.5 523,-384.5 476,-384.5"/>
<polyline fill="none" stroke="black" points="523,-407.5 476,-407.5 476,-384.5 523,-384.5 "/>
<text text-anchor="start" x="480" y="-392.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="422,-365.5 422,-384.5 "/>
<text text-anchor="start" x="379" y="-372.5" font-family="monospace" font-size="10.00">facies</text>
<polyline fill="none" stroke="black" points="476,-365.5 476,-384.5 "/>
<text text-anchor="start" x="426" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="479" y="-372.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;H5Writer -->
<g id="edge6" class="edge">
<title>FaciesBase&#45;&gt;H5Writer</title>
<path fill="none" stroke="black" d="M394.91,-358.87C383.44,-351.85 371.12,-345.14 359,-340 295.49,-313.05 271.51,-330.95 208,-304 198.91,-300.14 189.71,-295.4 180.83,-290.31"/>
<polygon fill="black" stroke="black" points="182.47,-287.22 172.09,-285.13 178.9,-293.24 182.47,-287.22"/>
</g>
<!-- FaciesBase&#45;&gt;CellularAutomaton -->
<g id="edge13" class="edge">
<title>FaciesBase&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M500.25,-358.81C523.64,-341.15 551.74,-319.93 577.2,-300.71"/>
<polygon fill="black" stroke="black" points="579.49,-303.37 585.36,-294.55 575.27,-297.78 579.49,-303.37"/>
</g>
<!-- Production -->
<g id="node10" class="node">
<title>Production</title>
<path fill="none" stroke="black" d="M476.5,-304C476.5,-304 229.5,-304 229.5,-304 223.5,-304 217.5,-298 217.5,-292 217.5,-292 217.5,-199 217.5,-199 217.5,-193 223.5,-187 229.5,-187 229.5,-187 476.5,-187 476.5,-187 482.5,-187 488.5,-193 488.5,-199 488.5,-199 488.5,-292 488.5,-292 488.5,-298 482.5,-304 476.5,-304"/>
<polyline fill="none" stroke="black" points="225,-273.5 482,-273.5 "/>
<text text-anchor="start" x="309.5" y="-282.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Production</text>
<polygon fill="#cccccc" stroke="transparent" points="225,-250.5 225,-273.5 294,-273.5 294,-250.5 225,-250.5"/>
<polyline fill="none" stroke="black" points="225,-250.5 294,-250.5 294,-273.5 225,-273.5 "/>
<text text-anchor="start" x="229" y="-258.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="294,-250.5 294,-273.5 435,-273.5 435,-250.5 294,-250.5"/>
<polygon fill="none" stroke="black" points="294,-250.5 294,-273.5 435,-273.5 435,-250.5 294,-250.5"/>
<text text-anchor="start" x="298" y="-258.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="435,-250.5 435,-273.5 482,-273.5 482,-250.5 435,-250.5"/>
<polyline fill="none" stroke="black" points="482,-273.5 435,-273.5 435,-250.5 482,-250.5 "/>
<text text-anchor="start" x="439" y="-258.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="294,-231.5 294,-250.5 "/>
<text text-anchor="start" x="229" y="-238.5" font-family="monospace" font-size="10.00">insolation</text>
<polyline fill="none" stroke="black" points="435,-231.5 435,-250.5 "/>
<text text-anchor="start" x="298" y="-238.5" font-family="monospace" font-size="10.00">maximum_growth_rate</text>
<text text-anchor="start" x="438" y="-238.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="294,-212.5 294,-231.5 "/>
<text text-anchor="start" x="229" y="-219.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="435,-212.5 435,-231.5 "/>
<text text-anchor="start" x="298" y="-219.5" font-family="monospace" font-size="10.00">extinction_coefficient</text>
<text text-anchor="start" x="438" y="-219.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="294,-193.5 294,-212.5 "/>
<text text-anchor="start" x="229" y="-200.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="435,-193.5 435,-212.5 "/>
<text text-anchor="start" x="298" y="-200.5" font-family="monospace" font-size="10.00">saturation_intensity</text>
<text text-anchor="start" x="438" y="-200.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;Production -->
<g id="edge9" class="edge">
<title>FaciesBase&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M424.28,-358.61C415.37,-344.61 405.05,-328.38 395.08,-312.69"/>
<polygon fill="black" stroke="black" points="397.91,-310.62 389.59,-304.05 392,-314.37 397.91,-310.62"/>
</g>
<!-- WaterDepth&#45;&gt;H5Writer -->
<g id="edge7" class="edge">
<title>WaterDepth&#45;&gt;H5Writer</title>
<path fill="none" stroke="black" d="M174.34,-339.98C165.19,-324.8 155.41,-308.58 146.62,-293.99"/>
<polygon fill="black" stroke="black" points="149.45,-291.9 141.29,-285.14 143.45,-295.52 149.45,-291.9"/>
</g>
<!-- WaterDepth&#45;&gt;Production -->
<g id="edge8" class="edge">
<title>WaterDepth&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M263.85,-339.98C272.69,-330.71 281.9,-321.05 290.9,-311.62"/>
<polygon fill="black" stroke="black" points="293.69,-313.76 298.06,-304.11 288.63,-308.93 293.69,-313.76"/>
</g>
<!-- CAProduction -->
<g id="node8" class="node">
<title>CAProduction</title>
<path fill="none" stroke="black" d="M402.5,-129.5C402.5,-129.5 303.5,-129.5 303.5,-129.5 297.5,-129.5 291.5,-123.5 291.5,-117.5 291.5,-117.5 291.5,-105.5 291.5,-105.5 291.5,-99.5 297.5,-93.5 303.5,-93.5 303.5,-93.5 402.5,-93.5 402.5,-93.5 408.5,-93.5 414.5,-99.5 414.5,-105.5 414.5,-105.5 414.5,-117.5 414.5,-117.5 414.5,-123.5 408.5,-129.5 402.5,-129.5"/>
<text text-anchor="start" x="298.5" y="-108.8" font-family="Times,serif" font-weight="bold" font-size="14.00">CAProduction</text>
</g>
<!-- CAProduction&#45;&gt;CAP -->
<g id="edge3" class="edge">
<title>CAProduction&#45;&gt;CAP</title>
<path fill="none" stroke="black" d="M322.34,-93.29C294.96,-77.92 254.84,-55.4 225.96,-39.19"/>
<polygon fill="black" stroke="black" points="227.44,-36 217.01,-34.16 224.01,-42.11 227.44,-36"/>
</g>
<!-- CellularAutomaton&#45;&gt;CAProduction -->
<g id="edge10" class="edge">
<title>CellularAutomaton&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M541.3,-196.47C492.99,-174.93 438.49,-150.62 400.59,-133.72"/>
<polygon fill="black" stroke="black" points="401.89,-130.47 391.33,-129.59 399.04,-136.86 401.89,-130.47"/>
</g>
<!-- Production&#45;&gt;CAProduction -->
<g id="edge11" class="edge">
<title>Production&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M353,-186.99C353,-170.54 353,-153.38 353,-139.68"/>
<polygon fill="black" stroke="black" points="356.5,-139.52 353,-129.52 349.5,-139.52 356.5,-139.52"/>
</g>
</g>
</svg>
</div><div class="noweb-label">file:<i>src/Models/CAP.jl</i></div><pre><code class="language- julia hljs">@compose module CAP
@mixin Tag, H5Writer, CAProduction

using ..Common
using ..CAProduction: production
using ..TimeIntegration
using ..WaterDepth
using ModuleMixins: @for_each

export Input, Facies

function initial_state(input::Input)
    ca_state = CellularAutomaton.initial_state(input)
    for _ in 1:20
        CellularAutomaton.step!(input)(ca_state)
    end

    sediment_height = zeros(Height, input.box.grid_size...)
    return State(
        step=0, sediment_height=sediment_height,
        ca=ca_state.ca, ca_priority=ca_state.ca_priority)
end

function step!(input::Input)
    τ = production(input)
    step_ca = CellularAutomaton.step!(input)

    function (state::State)
        if mod(state.step, input.ca_interval) == 0
            step_ca(state)
        end

        prod = τ(state)
        Δη = sum(prod; dims=1)[1, :, :]
        state.sediment_height .+= Δη
        state.step += 1

        return Frame(
            production = prod,
            deposition = prod)
    end
end

function write_header(fid, input::AbstractInput)
    @for_each(P -&gt; P.write_header(fid, input), PARENTS)
end
end</code></pre><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bosscher-1992/">« Bosscher and Schlager 1992</a><a class="docs-footer-nextpage" href="../model-alcap/">ALCAPS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Wednesday 25 June 2025 16:47">Wednesday 25 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
