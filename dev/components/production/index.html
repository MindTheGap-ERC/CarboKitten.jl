<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Production · CarboKitten</title><meta name="title" content="Production · CarboKitten"/><meta property="og:title" content="Production · CarboKitten"/><meta property="twitter:title" content="Production · CarboKitten"/><meta name="description" content="Documentation for CarboKitten."/><meta property="og:description" content="Documentation for CarboKitten."/><meta property="twitter:description" content="Documentation for CarboKitten."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="CarboKitten logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CarboKitten</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../bosscher-1992/">Bosscher and Schlager 1992</a></li><li><a class="tocitem" href="../../ca-with-production/">Model with CA and Production</a></li><li><a class="tocitem" href="../../model-alcap/">ALCAPS</a></li><li><a class="tocitem" href="../../models/without-ca/">Model without CA</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../first_tutorial/">Tutorial (Pluto notebook)</a></li><li><a class="tocitem" href="../../cases/tabular-sea-level/">Tabular Sea Levels</a></li></ul></li><li><a class="tocitem" href="../../architecture/">Architecture</a></li><li><span class="tocitem">Model Components</span><ul><li><a class="tocitem" href="../components/">Components</a></li><li><a class="tocitem" href="../tag/">Tags</a></li><li><a class="tocitem" href="../boxes/">Boxes</a></li><li><a class="tocitem" href="../time/">Time</a></li><li><a class="tocitem" href="../output/">Output</a></li><li><a class="tocitem" href="../facies/">Facies</a></li><li><a class="tocitem" href="../cellular-automata/">Cellular Automata</a></li><li><a class="tocitem" href="../waterdepth/">Water Depth</a></li><li class="is-active"><a class="tocitem" href>Production</a><ul class="internal"><li><a class="tocitem" href="#CA-Production"><span>CA Production</span></a></li><li><a class="tocitem" href="#Tests"><span>Tests</span></a></li></ul></li><li><a class="tocitem" href="../sediment_buffer/">Sediment Buffers</a></li><li><a class="tocitem" href="../../active-layer-transport/">Active Layer Transport</a></li><li><a class="tocitem" href="../../onshore-transport/">Onshore Transport</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualizations</a></li><li><span class="tocitem">CarboCAT</span><ul><li><a class="tocitem" href="../../carbocat/">Summary</a></li></ul></li><li><span class="tocitem">Denudation</span><ul><li><a class="tocitem" href="../../denudation/denudation/">Denudation</a></li><li><a class="tocitem" href="../../denudation/empirical/">Empirical Denudation</a></li><li><a class="tocitem" href="../../denudation/chemical/">Chemical Dissolution</a></li><li><a class="tocitem" href="../../denudation/physical_erosion/">Physical Erosion</a></li></ul></li><li><span class="tocitem">Input &amp; Output</span><ul><li><a class="tocitem" href="../../input-methods/">Input Methods</a></li><li><a class="tocitem" href="../../output/abstract/">Output</a></li><li><a class="tocitem" href="../../output/h5writer/">HDF5 Output</a></li><li><a class="tocitem" href="../../output/memory-writer/">Output to Memory</a></li><li><a class="tocitem" href="../../data-export/">CSV Export</a></li><li><a class="tocitem" href="../../debugging/">Trouble shooting and diagnostics</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../../unitful/">Unitful</a></li><li><a class="tocitem" href="../../boxes/">Boxes</a></li><li><a class="tocitem" href="../../stencils/">Stencils</a></li><li><a class="tocitem" href="../../utility/">Utility</a></li><li><a class="tocitem" href="../../finite-difference-transport/">Finite Difference</a></li></ul></li><li><a class="tocitem" href="../../api/">API Documentation</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model Components</a></li><li class="is-active"><a href>Production</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Production</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl/blob/main/docs/transpiled/components/production.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Production"><a class="docs-heading-anchor" href="#Production">Production</a><a id="Production-1"></a><a class="docs-heading-anchor-permalink" href="#Production" title="Permalink"></a></h1><div class="component-dag" style="overflow: scroll"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Pages: 1 -->
<svg width="500pt" height="393pt"
 viewBox="0.00 0.00 500.00 393.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 389)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-389 496,-389 496,4 -4,4"/>
<!-- TimeIntegration -->
<g id="node1" class="node">
<title>TimeIntegration</title>
<path fill="none" stroke="black" d="M150,-385C150,-385 12,-385 12,-385 6,-385 0,-379 0,-373 0,-373 0,-318 0,-318 0,-312 6,-306 12,-306 12,-306 150,-306 150,-306 156,-306 162,-312 162,-318 162,-318 162,-373 162,-373 162,-379 156,-385 150,-385"/>
<polyline fill="none" stroke="black" points="7,-354.5 155,-354.5 "/>
<text text-anchor="start" x="15.5" y="-363.3" font-family="Times,serif" font-weight="bold" font-size="14.00">TimeIntegration</text>
<polygon fill="#cccccc" stroke="transparent" points="7,-331.5 7,-354.5 54,-354.5 54,-331.5 7,-331.5"/>
<polyline fill="none" stroke="black" points="7,-331.5 54,-331.5 54,-354.5 7,-354.5 "/>
<text text-anchor="start" x="11" y="-339.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="54,-331.5 54,-354.5 108,-354.5 108,-331.5 54,-331.5"/>
<polygon fill="none" stroke="black" points="54,-331.5 54,-354.5 108,-354.5 108,-331.5 54,-331.5"/>
<text text-anchor="start" x="58" y="-339.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="108,-331.5 108,-354.5 155,-354.5 155,-331.5 108,-331.5"/>
<polyline fill="none" stroke="black" points="155,-354.5 108,-354.5 108,-331.5 155,-331.5 "/>
<text text-anchor="start" x="112" y="-339.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="54,-312.5 54,-331.5 "/>
<text text-anchor="start" x="11" y="-319.5" font-family="monospace" font-size="10.00">time</text>
<polyline fill="none" stroke="black" points="108,-312.5 108,-331.5 "/>
<text text-anchor="start" x="58" y="-319.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="111" y="-319.5" font-family="monospace" font-size="10.00">step</text>
</g>
<!-- WaterDepth -->
<g id="node2" class="node">
<title>WaterDepth</title>
<path fill="none" stroke="black" d="M300,-270C300,-270 42,-270 42,-270 36,-270 30,-264 30,-258 30,-258 30,-165 30,-165 30,-159 36,-153 42,-153 42,-153 300,-153 300,-153 306,-153 312,-159 312,-165 312,-165 312,-258 312,-258 312,-264 306,-270 300,-270"/>
<polyline fill="none" stroke="black" points="37,-239.5 305,-239.5 "/>
<text text-anchor="start" x="123.5" y="-248.3" font-family="Times,serif" font-weight="bold" font-size="14.00">WaterDepth</text>
<polygon fill="#cccccc" stroke="transparent" points="37,-216.5 37,-239.5 154,-239.5 154,-216.5 37,-216.5"/>
<polyline fill="none" stroke="black" points="37,-216.5 154,-216.5 154,-239.5 37,-239.5 "/>
<text text-anchor="start" x="41" y="-224.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="154,-216.5 154,-239.5 208,-239.5 208,-216.5 154,-216.5"/>
<polygon fill="none" stroke="black" points="154,-216.5 154,-239.5 208,-239.5 208,-216.5 154,-216.5"/>
<text text-anchor="start" x="158" y="-224.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="208,-216.5 208,-239.5 305,-239.5 305,-216.5 208,-216.5"/>
<polyline fill="none" stroke="black" points="305,-239.5 208,-239.5 208,-216.5 305,-216.5 "/>
<text text-anchor="start" x="212" y="-224.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="154,-197.5 154,-216.5 "/>
<text text-anchor="start" x="41" y="-204.5" font-family="monospace" font-size="10.00">sea_level</text>
<polyline fill="none" stroke="black" points="208,-197.5 208,-216.5 "/>
<text text-anchor="start" x="158" y="-204.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="211" y="-204.5" font-family="monospace" font-size="10.00">sediment_height</text>
<polyline fill="none" stroke="black" points="154,-178.5 154,-197.5 "/>
<text text-anchor="start" x="41" y="-185.5" font-family="monospace" font-size="10.00">initial_topography</text>
<polyline fill="none" stroke="black" points="208,-178.5 208,-197.5 "/>
<text text-anchor="start" x="158" y="-185.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="211" y="-185.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="154,-159.5 154,-178.5 "/>
<text text-anchor="start" x="41" y="-166.5" font-family="monospace" font-size="10.00">subsidence_rate</text>
<polyline fill="none" stroke="black" points="208,-159.5 208,-178.5 "/>
<text text-anchor="start" x="158" y="-166.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="211" y="-166.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- TimeIntegration&#45;&gt;WaterDepth -->
<g id="edge1" class="edge">
<title>TimeIntegration&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M107.27,-305.97C113.07,-297.46 119.38,-288.21 125.69,-278.95"/>
<polygon fill="black" stroke="black" points="128.73,-280.7 131.48,-270.47 122.95,-276.76 128.73,-280.7"/>
</g>
<!-- Production -->
<g id="node5" class="node">
<title>Production</title>
<path fill="none" stroke="black" d="M414.5,-117C414.5,-117 167.5,-117 167.5,-117 161.5,-117 155.5,-111 155.5,-105 155.5,-105 155.5,-12 155.5,-12 155.5,-6 161.5,0 167.5,0 167.5,0 414.5,0 414.5,0 420.5,0 426.5,-6 426.5,-12 426.5,-12 426.5,-105 426.5,-105 426.5,-111 420.5,-117 414.5,-117"/>
<polyline fill="none" stroke="black" points="163,-86.5 420,-86.5 "/>
<text text-anchor="start" x="247.5" y="-95.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Production</text>
<polygon fill="#cccccc" stroke="transparent" points="163,-63.5 163,-86.5 232,-86.5 232,-63.5 163,-63.5"/>
<polyline fill="none" stroke="black" points="163,-63.5 232,-63.5 232,-86.5 163,-86.5 "/>
<text text-anchor="start" x="167" y="-71.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="232,-63.5 232,-86.5 373,-86.5 373,-63.5 232,-63.5"/>
<polygon fill="none" stroke="black" points="232,-63.5 232,-86.5 373,-86.5 373,-63.5 232,-63.5"/>
<text text-anchor="start" x="236" y="-71.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="373,-63.5 373,-86.5 420,-86.5 420,-63.5 373,-63.5"/>
<polyline fill="none" stroke="black" points="420,-86.5 373,-86.5 373,-63.5 420,-63.5 "/>
<text text-anchor="start" x="377" y="-71.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="232,-44.5 232,-63.5 "/>
<text text-anchor="start" x="167" y="-51.5" font-family="monospace" font-size="10.00">insolation</text>
<polyline fill="none" stroke="black" points="373,-44.5 373,-63.5 "/>
<text text-anchor="start" x="236" y="-51.5" font-family="monospace" font-size="10.00">maximum_growth_rate</text>
<text text-anchor="start" x="376" y="-51.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="232,-25.5 232,-44.5 "/>
<text text-anchor="start" x="167" y="-32.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="373,-25.5 373,-44.5 "/>
<text text-anchor="start" x="236" y="-32.5" font-family="monospace" font-size="10.00">extinction_coefficient</text>
<text text-anchor="start" x="376" y="-32.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="232,-6.5 232,-25.5 "/>
<text text-anchor="start" x="167" y="-13.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="373,-6.5 373,-25.5 "/>
<text text-anchor="start" x="236" y="-13.5" font-family="monospace" font-size="10.00">saturation_intensity</text>
<text text-anchor="start" x="376" y="-13.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- WaterDepth&#45;&gt;Production -->
<g id="edge3" class="edge">
<title>WaterDepth&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M216.71,-152.98C223.93,-143.89 231.45,-134.44 238.81,-125.18"/>
<polygon fill="black" stroke="black" points="241.74,-127.11 245.22,-117.11 236.26,-122.76 241.74,-127.11"/>
</g>
<!-- Boxes -->
<g id="node3" class="node">
<title>Boxes</title>
<path fill="none" stroke="black" d="M330,-385C330,-385 192,-385 192,-385 186,-385 180,-379 180,-373 180,-373 180,-318 180,-318 180,-312 186,-306 192,-306 192,-306 330,-306 330,-306 336,-306 342,-312 342,-318 342,-318 342,-373 342,-373 342,-379 336,-385 330,-385"/>
<polyline fill="none" stroke="black" points="187,-354.5 335,-354.5 "/>
<text text-anchor="start" x="237.5" y="-363.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Boxes</text>
<polygon fill="#cccccc" stroke="transparent" points="187,-331.5 187,-354.5 234,-354.5 234,-331.5 187,-331.5"/>
<polyline fill="none" stroke="black" points="187,-331.5 234,-331.5 234,-354.5 187,-354.5 "/>
<text text-anchor="start" x="191" y="-339.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="234,-331.5 234,-354.5 288,-354.5 288,-331.5 234,-331.5"/>
<polygon fill="none" stroke="black" points="234,-331.5 234,-354.5 288,-354.5 288,-331.5 234,-331.5"/>
<text text-anchor="start" x="238" y="-339.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="288,-331.5 288,-354.5 335,-354.5 335,-331.5 288,-331.5"/>
<polyline fill="none" stroke="black" points="335,-354.5 288,-354.5 288,-331.5 335,-331.5 "/>
<text text-anchor="start" x="292" y="-339.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="234,-312.5 234,-331.5 "/>
<text text-anchor="start" x="191" y="-319.5" font-family="monospace" font-size="10.00">box</text>
<polyline fill="none" stroke="black" points="288,-312.5 288,-331.5 "/>
<text text-anchor="start" x="238" y="-319.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="291" y="-319.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Boxes&#45;&gt;WaterDepth -->
<g id="edge2" class="edge">
<title>Boxes&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M234.73,-305.97C228.93,-297.46 222.62,-288.21 216.31,-278.95"/>
<polygon fill="black" stroke="black" points="219.05,-276.76 210.52,-270.47 213.27,-280.7 219.05,-276.76"/>
</g>
<!-- FaciesBase -->
<g id="node4" class="node">
<title>FaciesBase</title>
<path fill="none" stroke="black" d="M480,-251C480,-251 342,-251 342,-251 336,-251 330,-245 330,-239 330,-239 330,-184 330,-184 330,-178 336,-172 342,-172 342,-172 480,-172 480,-172 486,-172 492,-178 492,-184 492,-184 492,-239 492,-239 492,-245 486,-251 480,-251"/>
<polyline fill="none" stroke="black" points="337,-220.5 485,-220.5 "/>
<text text-anchor="start" x="367" y="-229.3" font-family="Times,serif" font-weight="bold" font-size="14.00">FaciesBase</text>
<polygon fill="#cccccc" stroke="transparent" points="337,-197.5 337,-220.5 384,-220.5 384,-197.5 337,-197.5"/>
<polyline fill="none" stroke="black" points="337,-197.5 384,-197.5 384,-220.5 337,-220.5 "/>
<text text-anchor="start" x="341" y="-205.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="384,-197.5 384,-220.5 438,-220.5 438,-197.5 384,-197.5"/>
<polygon fill="none" stroke="black" points="384,-197.5 384,-220.5 438,-220.5 438,-197.5 384,-197.5"/>
<text text-anchor="start" x="388" y="-205.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="438,-197.5 438,-220.5 485,-220.5 485,-197.5 438,-197.5"/>
<polyline fill="none" stroke="black" points="485,-220.5 438,-220.5 438,-197.5 485,-197.5 "/>
<text text-anchor="start" x="442" y="-205.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="384,-178.5 384,-197.5 "/>
<text text-anchor="start" x="341" y="-185.5" font-family="monospace" font-size="10.00">facies</text>
<polyline fill="none" stroke="black" points="438,-178.5 438,-197.5 "/>
<text text-anchor="start" x="388" y="-185.5" font-family="monospace" font-size="10.00">name</text>
<text text-anchor="start" x="441" y="-185.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;Production -->
<g id="edge4" class="edge">
<title>FaciesBase&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M380.1,-171.61C368.86,-157.48 355.83,-141.08 343.26,-125.26"/>
<polygon fill="black" stroke="black" points="345.7,-122.71 336.74,-117.05 340.22,-127.06 345.7,-122.71"/>
</g>
</g>
</svg>
</div><p>The <code>Production</code> module specifies the production rate following the model by Bosscher &amp; Schlager 1992 [<a href="../../carbocat/#Bosscher1992">1</a>]. The growth rate is given as</p><p class="math-container">\[g(w) = g_m \tanh\left({{I_0 e^{-kw}} \over {I_k}}\right).\]</p><p>This can be understood as a smooth transition between the maximum growth rate under saturated conditions, and exponential decay due to light intensity dropping with greater water depth.</p><div class="noweb-label">⪡component-production-rate⪢≣</div><pre><code class="language- julia hljs">function production_rate(insolation, facies, water_depth)
    gₘ = facies.maximum_growth_rate
    I = insolation / facies.saturation_intensity
    x = water_depth * facies.extinction_coefficient
    return x &gt; 0.0 ? gₘ * tanh(I * exp(-x)) : 0.0u&quot;m/Myr&quot;
end

function capped_production(insolation, facies, water_depth, dt)
    p = production_rate(insolation, facies, water_depth) * dt
    return min(p, max(0.0u&quot;m&quot;, water_depth))
end</code></pre><p>From just this equation we can define a uniform production process. This requires that we have a <code>Facies</code> that defines the <code>maximum_growth_rate</code>, <code>extinction_coefficient</code> and <code>saturation_intensity</code>.</p><p>The <code>insolation</code> input may be given as a scalar quantity, say <code>400u&quot;W/m^2&quot;</code>, or as a function of time.</p><div class="noweb-label">file:<i>src/Components/Production.jl</i></div><pre><code class="language- julia hljs">@compose module Production
@mixin TimeIntegration, WaterDepth, FaciesBase
using ..Common
using ..WaterDepth: water_depth
using ..TimeIntegration: time, write_times
using HDF5
using Logging

export production_rate, capped_production, uniform_production

@kwdef struct Facies &lt;: AbstractFacies
    maximum_growth_rate::Rate = 0.0u&quot;m/Myr&quot;
    extinction_coefficient::typeof(1.0u&quot;m^-1&quot;) = 0.0u&quot;m^-1&quot;
    saturation_intensity::Intensity = 1.0u&quot;W/m^2&quot;
end

@kwdef struct Input &lt;: AbstractInput
    insolation
end

function insolation(input::AbstractInput)
    insolation = input.insolation
    tprop = input.time
    if insolation isa Quantity
        return s -&gt; insolation
    end
    if insolation isa AbstractVector
        @info &quot;Reading insolation from a table&quot;
        return s -&gt; insolation[s.step+1]
    end
    @info &quot;Reading insolation from a function&quot;
    function (s::AbstractState)
        t = time(tprop, s)
        return insolation(t)
    end
end

function write_header(input::AbstractInput, output::AbstractOutput)
    if input.insolation isa Quantity
        set_attribute(output, &quot;insolation&quot;,
            fill(input.insolation |&gt; in_units_of(u&quot;W/m^2&quot;), input.time.steps))
    elseif input.insolation isa AbstractVector
        set_attribute(output, &quot;insolation&quot;,
            input.insolation |&gt; in_units_of(u&quot;W/m^2&quot;))
    else
        t = write_times(input)[1:end-1]
        set_attribute(output, &quot;insolation&quot;,
            input.insolation.(t) |&gt; in_units_of(u&quot;W/m^2&quot;))
    end

    for (i, f) in enumerate(input.facies)
        set_attribute(output, &quot;facies$(i)/maximum_growth_rate&quot;, f.maximum_growth_rate |&gt; in_units_of(u&quot;m/Myr&quot;))
        set_attribute(output, &quot;facies$(i)/extinction_coefficient&quot;, f.extinction_coefficient |&gt; in_units_of(u&quot;m^-1&quot;))
        set_attribute(output, &quot;facies$(i)/saturation_intensity&quot;, f.saturation_intensity |&gt; in_units_of(u&quot;W/m^2&quot;))
    end
end

&lt;&lt;component-production-rate&gt;&gt;

function uniform_production(input::AbstractInput)
    w = water_depth(input)
    na = [CartesianIndex()]
    insolation_func = insolation(input)
    facies = input.facies
    dt = input.time.Δt

    p(state::AbstractState, wd::AbstractMatrix) =
        capped_production.(insolation_func(state), facies[:, na, na], wd[na, :, :], dt)

    p(state::AbstractState) = p(state, w(state))

    return p
end
end</code></pre><h2 id="CA-Production"><a class="docs-heading-anchor" href="#CA-Production">CA Production</a><a id="CA-Production-1"></a><a class="docs-heading-anchor-permalink" href="#CA-Production" title="Permalink"></a></h2><div class="component-dag" style="overflow: scroll"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Pages: 1 -->
<svg width="614pt" height="465pt"
 viewBox="0.00 0.00 613.50 465.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 461)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-461 609.5,-461 609.5,4 -4,4"/>
<!-- TimeIntegration -->
<g id="node1" class="node">
<title>TimeIntegration</title>
<path fill="none" stroke="black" d="M210,-457C210,-457 72,-457 72,-457 66,-457 60,-451 60,-445 60,-445 60,-390 60,-390 60,-384 66,-378 72,-378 72,-378 210,-378 210,-378 216,-378 222,-384 222,-390 222,-390 222,-445 222,-445 222,-451 216,-457 210,-457"/>
<polyline fill="none" stroke="black" points="67,-426.5 215,-426.5 "/>
<text text-anchor="start" x="75.5" y="-435.3" font-family="Times,serif" font-weight="bold" font-size="14.00">TimeIntegration</text>
<polygon fill="#cccccc" stroke="transparent" points="67,-403.5 67,-426.5 114,-426.5 114,-403.5 67,-403.5"/>
<polyline fill="none" stroke="black" points="67,-403.5 114,-403.5 114,-426.5 67,-426.5 "/>
<text text-anchor="start" x="71" y="-411.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="114,-403.5 114,-426.5 168,-426.5 168,-403.5 114,-403.5"/>
<polygon fill="none" stroke="black" points="114,-403.5 114,-426.5 168,-426.5 168,-403.5 114,-403.5"/>
<text text-anchor="start" x="118" y="-411.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="168,-403.5 168,-426.5 215,-426.5 215,-403.5 168,-403.5"/>
<polyline fill="none" stroke="black" points="215,-426.5 168,-426.5 168,-403.5 215,-403.5 "/>
<text text-anchor="start" x="172" y="-411.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="114,-384.5 114,-403.5 "/>
<text text-anchor="start" x="71" y="-391.5" font-family="monospace" font-size="10.00">time</text>
<polyline fill="none" stroke="black" points="168,-384.5 168,-403.5 "/>
<text text-anchor="start" x="118" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="171" y="-391.5" font-family="monospace" font-size="10.00">step</text>
</g>
<!-- WaterDepth -->
<g id="node3" class="node">
<title>WaterDepth</title>
<path fill="none" stroke="black" d="M270,-342C270,-342 12,-342 12,-342 6,-342 0,-336 0,-330 0,-330 0,-237 0,-237 0,-231 6,-225 12,-225 12,-225 270,-225 270,-225 276,-225 282,-231 282,-237 282,-237 282,-330 282,-330 282,-336 276,-342 270,-342"/>
<polyline fill="none" stroke="black" points="7,-311.5 275,-311.5 "/>
<text text-anchor="start" x="93.5" y="-320.3" font-family="Times,serif" font-weight="bold" font-size="14.00">WaterDepth</text>
<polygon fill="#cccccc" stroke="transparent" points="7,-288.5 7,-311.5 124,-311.5 124,-288.5 7,-288.5"/>
<polyline fill="none" stroke="black" points="7,-288.5 124,-288.5 124,-311.5 7,-311.5 "/>
<text text-anchor="start" x="11" y="-296.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="124,-288.5 124,-311.5 178,-311.5 178,-288.5 124,-288.5"/>
<polygon fill="none" stroke="black" points="124,-288.5 124,-311.5 178,-311.5 178,-288.5 124,-288.5"/>
<text text-anchor="start" x="128" y="-296.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="178,-288.5 178,-311.5 275,-311.5 275,-288.5 178,-288.5"/>
<polyline fill="none" stroke="black" points="275,-311.5 178,-311.5 178,-288.5 275,-288.5 "/>
<text text-anchor="start" x="182" y="-296.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="124,-269.5 124,-288.5 "/>
<text text-anchor="start" x="11" y="-276.5" font-family="monospace" font-size="10.00">sea_level</text>
<polyline fill="none" stroke="black" points="178,-269.5 178,-288.5 "/>
<text text-anchor="start" x="128" y="-276.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="181" y="-276.5" font-family="monospace" font-size="10.00">sediment_height</text>
<polyline fill="none" stroke="black" points="124,-250.5 124,-269.5 "/>
<text text-anchor="start" x="11" y="-257.5" font-family="monospace" font-size="10.00">initial_topography</text>
<polyline fill="none" stroke="black" points="178,-250.5 178,-269.5 "/>
<text text-anchor="start" x="128" y="-257.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="181" y="-257.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="124,-231.5 124,-250.5 "/>
<text text-anchor="start" x="11" y="-238.5" font-family="monospace" font-size="10.00">subsidence_rate</text>
<polyline fill="none" stroke="black" points="178,-231.5 178,-250.5 "/>
<text text-anchor="start" x="128" y="-238.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="181" y="-238.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- TimeIntegration&#45;&gt;WaterDepth -->
<g id="edge1" class="edge">
<title>TimeIntegration&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M141,-377.97C141,-369.98 141,-361.34 141,-352.65"/>
<polygon fill="black" stroke="black" points="144.5,-352.47 141,-342.47 137.5,-352.47 144.5,-352.47"/>
</g>
<!-- Boxes -->
<g id="node2" class="node">
<title>Boxes</title>
<path fill="none" stroke="black" d="M474,-457C474,-457 336,-457 336,-457 330,-457 324,-451 324,-445 324,-445 324,-390 324,-390 324,-384 330,-378 336,-378 336,-378 474,-378 474,-378 480,-378 486,-384 486,-390 486,-390 486,-445 486,-445 486,-451 480,-457 474,-457"/>
<polyline fill="none" stroke="black" points="331,-426.5 479,-426.5 "/>
<text text-anchor="start" x="381.5" y="-435.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Boxes</text>
<polygon fill="#cccccc" stroke="transparent" points="331,-403.5 331,-426.5 378,-426.5 378,-403.5 331,-403.5"/>
<polyline fill="none" stroke="black" points="331,-403.5 378,-403.5 378,-426.5 331,-426.5 "/>
<text text-anchor="start" x="335" y="-411.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="378,-403.5 378,-426.5 432,-426.5 432,-403.5 378,-403.5"/>
<polygon fill="none" stroke="black" points="378,-403.5 378,-426.5 432,-426.5 432,-403.5 378,-403.5"/>
<text text-anchor="start" x="382" y="-411.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="432,-403.5 432,-426.5 479,-426.5 479,-403.5 432,-403.5"/>
<polyline fill="none" stroke="black" points="479,-426.5 432,-426.5 432,-403.5 479,-403.5 "/>
<text text-anchor="start" x="436" y="-411.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="378,-384.5 378,-403.5 "/>
<text text-anchor="start" x="335" y="-391.5" font-family="monospace" font-size="10.00">box</text>
<polyline fill="none" stroke="black" points="432,-384.5 432,-403.5 "/>
<text text-anchor="start" x="382" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="435" y="-391.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Boxes&#45;&gt;WaterDepth -->
<g id="edge2" class="edge">
<title>Boxes&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M327.93,-377.97C308.35,-368.18 286.82,-357.41 265.54,-346.77"/>
<polygon fill="black" stroke="black" points="266.95,-343.56 256.44,-342.22 263.82,-349.82 266.95,-343.56"/>
</g>
<!-- CellularAutomaton -->
<g id="node7" class="node">
<title>CellularAutomaton</title>
<path fill="none" stroke="black" d="M593.5,-189C593.5,-189 332.5,-189 332.5,-189 326.5,-189 320.5,-183 320.5,-177 320.5,-177 320.5,-84 320.5,-84 320.5,-78 326.5,-72 332.5,-72 332.5,-72 593.5,-72 593.5,-72 599.5,-72 605.5,-78 605.5,-84 605.5,-84 605.5,-177 605.5,-177 605.5,-183 599.5,-189 593.5,-189"/>
<polyline fill="none" stroke="black" points="328,-158.5 599,-158.5 "/>
<text text-anchor="start" x="388" y="-167.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CellularAutomaton</text>
<polygon fill="#cccccc" stroke="transparent" points="328,-135.5 328,-158.5 421,-158.5 421,-135.5 328,-135.5"/>
<polyline fill="none" stroke="black" points="328,-135.5 421,-135.5 421,-158.5 328,-158.5 "/>
<text text-anchor="start" x="332" y="-143.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="421,-135.5 421,-158.5 526,-158.5 526,-135.5 421,-135.5"/>
<polygon fill="none" stroke="black" points="421,-135.5 421,-158.5 526,-158.5 526,-135.5 421,-135.5"/>
<text text-anchor="start" x="425" y="-143.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="526,-135.5 526,-158.5 599,-158.5 599,-135.5 526,-135.5"/>
<polyline fill="none" stroke="black" points="599,-158.5 526,-158.5 526,-135.5 599,-135.5 "/>
<text text-anchor="start" x="530" y="-143.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="421,-116.5 421,-135.5 "/>
<text text-anchor="start" x="332" y="-123.5" font-family="monospace" font-size="10.00">ca_interval</text>
<polyline fill="none" stroke="black" points="526,-116.5 526,-135.5 "/>
<text text-anchor="start" x="425" y="-123.5" font-family="monospace" font-size="10.00">viability_range</text>
<text text-anchor="start" x="529" y="-123.5" font-family="monospace" font-size="10.00">ca</text>
<polyline fill="none" stroke="black" points="421,-97.5 421,-116.5 "/>
<text text-anchor="start" x="332" y="-104.5" font-family="monospace" font-size="10.00">ca_random_seed</text>
<polyline fill="none" stroke="black" points="526,-97.5 526,-116.5 "/>
<text text-anchor="start" x="425" y="-104.5" font-family="monospace" font-size="10.00">activation_range</text>
<text text-anchor="start" x="529" y="-104.5" font-family="monospace" font-size="10.00">ca_priority</text>
<polyline fill="none" stroke="black" points="421,-78.5 421,-97.5 "/>
<text text-anchor="start" x="332" y="-85.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="526,-78.5 526,-97.5 "/>
<text text-anchor="start" x="425" y="-85.5" font-family="monospace" font-size="10.00">active</text>
<text text-anchor="start" x="529" y="-85.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Boxes&#45;&gt;CellularAutomaton -->
<g id="edge7" class="edge">
<title>Boxes&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M448.74,-377.61C457.81,-367.05 466.1,-354.93 471,-342 488.23,-296.57 485.42,-241.6 478.73,-199.23"/>
<polygon fill="black" stroke="black" points="482.17,-198.58 477.06,-189.3 475.27,-199.74 482.17,-198.58"/>
</g>
<!-- Production -->
<g id="node5" class="node">
<title>Production</title>
<path fill="none" stroke="black" d="M290.5,-189C290.5,-189 43.5,-189 43.5,-189 37.5,-189 31.5,-183 31.5,-177 31.5,-177 31.5,-84 31.5,-84 31.5,-78 37.5,-72 43.5,-72 43.5,-72 290.5,-72 290.5,-72 296.5,-72 302.5,-78 302.5,-84 302.5,-84 302.5,-177 302.5,-177 302.5,-183 296.5,-189 290.5,-189"/>
<polyline fill="none" stroke="black" points="39,-158.5 296,-158.5 "/>
<text text-anchor="start" x="123.5" y="-167.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Production</text>
<polygon fill="#cccccc" stroke="transparent" points="39,-135.5 39,-158.5 108,-158.5 108,-135.5 39,-135.5"/>
<polyline fill="none" stroke="black" points="39,-135.5 108,-135.5 108,-158.5 39,-158.5 "/>
<text text-anchor="start" x="43" y="-143.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="108,-135.5 108,-158.5 249,-158.5 249,-135.5 108,-135.5"/>
<polygon fill="none" stroke="black" points="108,-135.5 108,-158.5 249,-158.5 249,-135.5 108,-135.5"/>
<text text-anchor="start" x="112" y="-143.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="249,-135.5 249,-158.5 296,-158.5 296,-135.5 249,-135.5"/>
<polyline fill="none" stroke="black" points="296,-158.5 249,-158.5 249,-135.5 296,-135.5 "/>
<text text-anchor="start" x="253" y="-143.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="108,-116.5 108,-135.5 "/>
<text text-anchor="start" x="43" y="-123.5" font-family="monospace" font-size="10.00">insolation</text>
<polyline fill="none" stroke="black" points="249,-116.5 249,-135.5 "/>
<text text-anchor="start" x="112" y="-123.5" font-family="monospace" font-size="10.00">maximum_growth_rate</text>
<text text-anchor="start" x="252" y="-123.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="108,-97.5 108,-116.5 "/>
<text text-anchor="start" x="43" y="-104.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="249,-97.5 249,-116.5 "/>
<text text-anchor="start" x="112" y="-104.5" font-family="monospace" font-size="10.00">extinction_coefficient</text>
<text text-anchor="start" x="252" y="-104.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="108,-78.5 108,-97.5 "/>
<text text-anchor="start" x="43" y="-85.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="249,-78.5 249,-97.5 "/>
<text text-anchor="start" x="112" y="-85.5" font-family="monospace" font-size="10.00">saturation_intensity</text>
<text text-anchor="start" x="252" y="-85.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- WaterDepth&#45;&gt;Production -->
<g id="edge3" class="edge">
<title>WaterDepth&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M150.9,-224.98C152.36,-216.54 153.87,-207.77 155.35,-199.14"/>
<polygon fill="black" stroke="black" points="158.83,-199.56 157.08,-189.11 151.93,-198.37 158.83,-199.56"/>
</g>
<!-- FaciesBase -->
<g id="node4" class="node">
<title>FaciesBase</title>
<path fill="none" stroke="black" d="M450,-323C450,-323 312,-323 312,-323 306,-323 300,-317 300,-311 300,-311 300,-256 300,-256 300,-250 306,-244 312,-244 312,-244 450,-244 450,-244 456,-244 462,-250 462,-256 462,-256 462,-311 462,-311 462,-317 456,-323 450,-323"/>
<polyline fill="none" stroke="black" points="307,-292.5 455,-292.5 "/>
<text text-anchor="start" x="337" y="-301.3" font-family="Times,serif" font-weight="bold" font-size="14.00">FaciesBase</text>
<polygon fill="#cccccc" stroke="transparent" points="307,-269.5 307,-292.5 354,-292.5 354,-269.5 307,-269.5"/>
<polyline fill="none" stroke="black" points="307,-269.5 354,-269.5 354,-292.5 307,-292.5 "/>
<text text-anchor="start" x="311" y="-277.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="354,-269.5 354,-292.5 408,-292.5 408,-269.5 354,-269.5"/>
<polygon fill="none" stroke="black" points="354,-269.5 354,-292.5 408,-292.5 408,-269.5 354,-269.5"/>
<text text-anchor="start" x="358" y="-277.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="408,-269.5 408,-292.5 455,-292.5 455,-269.5 408,-269.5"/>
<polyline fill="none" stroke="black" points="455,-292.5 408,-292.5 408,-269.5 455,-269.5 "/>
<text text-anchor="start" x="412" y="-277.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="354,-250.5 354,-269.5 "/>
<text text-anchor="start" x="311" y="-257.5" font-family="monospace" font-size="10.00">facies</text>
<polyline fill="none" stroke="black" points="408,-250.5 408,-269.5 "/>
<text text-anchor="start" x="358" y="-257.5" font-family="monospace" font-size="10.00">name</text>
<text text-anchor="start" x="411" y="-257.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;Production -->
<g id="edge4" class="edge">
<title>FaciesBase&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M326.17,-243.81C305.12,-228.96 280.51,-211.59 257.01,-195.01"/>
<polygon fill="black" stroke="black" points="258.95,-192.1 248.76,-189.19 254.91,-197.82 258.95,-192.1"/>
</g>
<!-- FaciesBase&#45;&gt;CellularAutomaton -->
<g id="edge8" class="edge">
<title>FaciesBase&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M402.12,-243.61C409.65,-229.73 418.37,-213.68 426.82,-198.13"/>
<polygon fill="black" stroke="black" points="430.05,-199.51 431.75,-189.05 423.9,-196.17 430.05,-199.51"/>
</g>
<!-- CAProduction -->
<g id="node6" class="node">
<title>CAProduction</title>
<path fill="none" stroke="black" d="M364.5,-36C364.5,-36 265.5,-36 265.5,-36 259.5,-36 253.5,-30 253.5,-24 253.5,-24 253.5,-12 253.5,-12 253.5,-6 259.5,0 265.5,0 265.5,0 364.5,0 364.5,0 370.5,0 376.5,-6 376.5,-12 376.5,-12 376.5,-24 376.5,-24 376.5,-30 370.5,-36 364.5,-36"/>
<text text-anchor="start" x="260.5" y="-15.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CAProduction</text>
</g>
<!-- Production&#45;&gt;CAProduction -->
<g id="edge6" class="edge">
<title>Production&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M244.03,-71.98C258.16,-61.43 272.15,-51 283.92,-42.21"/>
<polygon fill="black" stroke="black" points="286.14,-44.91 292.06,-36.12 281.96,-39.3 286.14,-44.91"/>
</g>
<!-- CellularAutomaton&#45;&gt;CAProduction -->
<g id="edge5" class="edge">
<title>CellularAutomaton&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M385.97,-71.98C371.84,-61.43 357.85,-51 346.08,-42.21"/>
<polygon fill="black" stroke="black" points="348.04,-39.3 337.94,-36.12 343.86,-44.91 348.04,-39.3"/>
</g>
</g>
</svg>
</div><p>The <code>CAProduction</code> component gives production that depends on the provided CA.</p><div class="noweb-label">file:<i>src/Components/CAProduction.jl</i></div><pre><code class="language- julia hljs">@compose module CAProduction
    @mixin TimeIntegration, CellularAutomaton, Production
    using ..Common
    using ..Production: production_rate, insolation
    using ..WaterDepth: water_depth
    using Logging

    function production(input::AbstractInput)
        w = water_depth(input)
        na = [CartesianIndex()]
        output_ = Array{Amount, 3}(undef, n_facies(input), input.box.grid_size...)

        w = water_depth(input)
        s = insolation(input)
        n_f = n_facies(input)
        facies = input.facies
        dt = input.time.Δt

        function p(state::AbstractState, wd::AbstractMatrix)::Array{Amount,3}
            output::Array{Amount, 3} = output_
            insolation::typeof(1.0u&quot;W/m^2&quot;) = s(state)
            for i in eachindex(IndexCartesian(), wd)
                for f in 1:n_f
                    output[f, i[1], i[2]] = f != state.ca[i] ? 0.0u&quot;m&quot; :
                    capped_production(insolation, facies[f], wd[i], dt)
                end
            end
            return output
        end

        @inline p(state::AbstractState) = p(state, w(state))

        return p
    end
end</code></pre><h2 id="Tests"><a class="docs-heading-anchor" href="#Tests">Tests</a><a id="Tests-1"></a><a class="docs-heading-anchor-permalink" href="#Tests" title="Permalink"></a></h2><h3 id="If-production-is-higher-in-shallower-water"><a class="docs-heading-anchor" href="#If-production-is-higher-in-shallower-water">If production is higher in shallower water</a><a id="If-production-is-higher-in-shallower-water-1"></a><a class="docs-heading-anchor-permalink" href="#If-production-is-higher-in-shallower-water" title="Permalink"></a></h3><div class="noweb-label">⪡production-spec⪢≣</div><pre><code class="language- julia hljs">@testset &quot;Components/Production&quot; begin
    let facies = Facies(
            maximum_growth_rate = 500u&quot;m/Myr&quot;,
            extinction_coefficient = 0.8u&quot;m^-1&quot;,
            saturation_intensity = 60u&quot;W/m^2&quot;),
        input = Input(
            box = Box{Periodic{2}}(grid_size=(10, 1), phys_scale=1.0u&quot;m&quot;),
            time = TimeProperties(Δt=1.0u&quot;kyr&quot;, steps=10),
            sea_level = t -&gt; 0.0u&quot;m&quot;,
            initial_topography = (x, y) -&gt; -10u&quot;m&quot;,
            subsidence_rate = 0.0u&quot;m/Myr&quot;,
            facies = [facies],
            insolation = 400.0u&quot;W/m^2&quot;)

        state = initial_state(input)
        prod = uniform_production(input)(state)
        @test all(prod[1:end-1,:] .&gt;= prod[2:end,:])
    end
end</code></pre><h3 id="Variable-insolation"><a class="docs-heading-anchor" href="#Variable-insolation">Variable insolation</a><a id="Variable-insolation-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-insolation" title="Permalink"></a></h3><p>If insolation increases linearly with time, production at t = 10 should be higher than at t = 1.</p><div class="noweb-label">⪡production-spec⪢≣</div><pre><code class="language- julia hljs">@testset &quot;Components/Production/variable_insolation&quot; begin
    let facies = Facies(
            maximum_growth_rate = 500u&quot;m/Myr&quot;,
            extinction_coefficient = 0.8u&quot;m^-1&quot;,
            saturation_intensity = 60u&quot;W/m^2&quot;),
        input = Input(
            box = Box{Periodic{2}}(grid_size=(10, 1), phys_scale=1.0u&quot;m&quot;),
            time = TimeProperties(Δt=1.0u&quot;kyr&quot;, steps=10),
            sea_level = t -&gt; 0.0u&quot;m&quot;,
            initial_topography = (x, y) -&gt; -10u&quot;m&quot;,
            subsidence_rate = 0.0u&quot;m/Myr&quot;,
            facies = [facies],
            insolation = t -&gt; 40.0u&quot;W/m^2/kyr&quot; * t)

        state = initial_state(input)
        state.step = 1
        prod1 = copy(uniform_production(input)(state))
        state.step = 10
        prod2 = copy(uniform_production(input)(state))
        @test all(prod2 .&gt; prod1)
    end
end</code></pre><div class="noweb-label">file:<i>test/Components/ProductionSpec.jl</i></div><pre><code class="language- julia hljs">module ProductionSpec
    using Test
    using CarboKitten.Components.Common
    using CarboKitten.Components.Production: Facies, Input, uniform_production
    using CarboKitten.Components.WaterDepth: initial_state

    &lt;&lt;production-spec&gt;&gt;
end</code></pre><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../waterdepth/">« Water Depth</a><a class="docs-footer-nextpage" href="../sediment_buffer/">Sediment Buffers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Monday 27 October 2025 21:31">Monday 27 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
