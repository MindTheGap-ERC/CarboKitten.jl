<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Chemical Dissolution · CarboKitten</title><meta name="title" content="Chemical Dissolution · CarboKitten"/><meta property="og:title" content="Chemical Dissolution · CarboKitten"/><meta property="twitter:title" content="Chemical Dissolution · CarboKitten"/><meta name="description" content="Documentation for CarboKitten."/><meta property="og:description" content="Documentation for CarboKitten."/><meta property="twitter:description" content="Documentation for CarboKitten."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CarboKitten</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../bosscher-1992/">Bosscher and Schlager 1992</a></li><li><a class="tocitem" href="../../ca-with-production/">Model with CA and Production</a></li><li><a class="tocitem" href="../../model-alcap/">ALCAPS</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../first_tutorial/">Tutorial (Pluto notebook)</a></li><li><a class="tocitem" href="../../cases/tabular-sea-level/">Tabular Sea Levels</a></li></ul></li><li><a class="tocitem" href="../../architecture/">Architecture</a></li><li><span class="tocitem">Model Components</span><ul><li><a class="tocitem" href="../../components/components/">Components</a></li><li><a class="tocitem" href="../../components/tag/">Tags</a></li><li><a class="tocitem" href="../../components/boxes/">Boxes</a></li><li><a class="tocitem" href="../../components/time/">Time</a></li><li><a class="tocitem" href="../../components/facies/">Facies</a></li><li><a class="tocitem" href="../../components/cellular-automata/">Cellular Automata</a></li><li><a class="tocitem" href="../../components/waterdepth/">Water Depth</a></li><li><a class="tocitem" href="../../components/production/">Production</a></li><li><a class="tocitem" href="../../components/hdf5/">HDF5 Writer</a></li><li><a class="tocitem" href="../../components/sediment_buffer/">Sediment Buffers</a></li><li><a class="tocitem" href="../../active-layer-transport/">Active Layer Transport</a></li><li><a class="tocitem" href="../../onshore-transport/">Onshore Transport</a></li></ul></li><li><a class="tocitem" href="../../visualization/">Visualizations</a></li><li><span class="tocitem">CarboCAT</span><ul><li><a class="tocitem" href="../../carbocat/">Summary</a></li></ul></li><li><span class="tocitem">Denudation</span><ul><li><a class="tocitem" href="../denudation/">Denudation</a></li><li><a class="tocitem" href="../empirical/">Empirical Denudation</a></li><li class="is-active"><a class="tocitem" href>Chemical Dissolution</a><ul class="internal"><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><a class="tocitem" href="../physical_erosion/">Physical Erosion</a></li></ul></li><li><span class="tocitem">Output</span><ul><li><a class="tocitem" href="../../data-export/">CSV Export</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../../unitful/">Unitful</a></li><li><a class="tocitem" href="../../boxes/">Boxes</a></li><li><a class="tocitem" href="../../stencils/">Stencils</a></li><li><a class="tocitem" href="../../utility/">Utility</a></li></ul></li><li><a class="tocitem" href="../../api/">API Documentation</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Denudation</a></li><li class="is-active"><a href>Chemical Dissolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Chemical Dissolution</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl/blob/main/docs/transpiled/denudation/chemical.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Chemical-dissolution"><a class="docs-heading-anchor" href="#Chemical-dissolution">Chemical dissolution</a><a id="Chemical-dissolution-1"></a><a class="docs-heading-anchor-permalink" href="#Chemical-dissolution" title="Permalink"></a></h1><p>The details could be found in paper by [<a href="../../references/#Kaufmann2001">11</a>].</p><p>Limestone is made of <span>$CaCO_3$</span>, easily dissolved. This depends mainly on precipitation (rainfall) and temperature. The paper used equation 1 to quantify this process.</p><p class="math-container">\[\frac{dh}{dt} = 0.001\ \kappa_c\ {{q_i} \over {A_i}}\]</p><p>Herein <span>$dh/dt$</span> is the chemical weathering rate and the unit is in m/s. Other parameters are defined as: <span>$q_i$</span> is the discharge of water at a certain cell. <span>$A_i$</span> is the surface area of the cell. If we assume there would be no surface water on land, <span>$q_i$</span> reduces to precipitation – evaporation. Let’s set it to 400 mm/y for now. Therefore equation 1 could be reduced to Equation 2.</p><p class="math-container">\[\frac{dh}{dt} = 0.001\ \kappa_c\  I\]</p><p>Where <span>$I$</span> is runoff (mm/y?). The parameter <span>$\kappa_c$</span> is dimensionless and should be described by equation 3:</p><p class="math-container">\[\kappa_c = 40\ 1000\ \frac{[Ca^{2+}]_{eq}}{\rho}\]</p><p>Parameter ρ is the density of calcite, and we choose 2700 <span>$kg/m^3$</span> here. <span>$[Ca^{2+}]_{eq}$</span> is defined in equation 4:</p><p class="math-container">\[[Ca^{2+}]_{eq} = {{(PCO_2\ (K_1\ K_C\ K_H)} \over {(4\ K_2\times \gamma Ca\ (\gamma HCO_3)^2))^{(1/3)}}}\]</p><p>Mass balance coefficients <span>$K_1$</span>, <span>$K_2$</span>, <span>$K_C$</span>, <span>$K_H$</span> depend on temperature. <span>$_PCO_2$</span> is assumed to be between <span>$10^{-1.5} ATM$</span> to <span>$10^{-3.5} ATM$</span>.</p><p>Other parameters can be found in the following table by [<a href="../../references/#Kaufmann2001">11</a>].</p><table><tr><th style="text-align: right">Parameter</th><th style="text-align: right">Description</th><th style="text-align: right">Unit</th><th style="text-align: right">Value</th></tr><tr><td style="text-align: right"><em>T</em></td><td style="text-align: right">Absolute temperature</td><td style="text-align: right">[°K]</td><td style="text-align: right">Tc + 273.16</td></tr><tr><td style="text-align: right"><em>I</em></td><td style="text-align: right">Ion activity</td><td style="text-align: right">[-]</td><td style="text-align: right">0.1</td></tr><tr><td style="text-align: right"><span>$A^*$</span></td><td style="text-align: right">Debye-Hückel coefficient</td><td style="text-align: right">[-]</td><td style="text-align: right"><span>$-0.4883 + 8.074 \times 10^{-4}T_c$</span></td></tr><tr><td style="text-align: right"><span>$B^*$</span></td><td style="text-align: right">Debye-Hückel coefficient</td><td style="text-align: right">[-]</td><td style="text-align: right"><span>$-0.3241 + 1.600 \times 10^{-4}T_c$</span></td></tr><tr><td style="text-align: right"><span>$log \gamma Ca\dagger$</span></td><td style="text-align: right">Activity coefficient</td><td style="text-align: right">[-]</td><td style="text-align: right"><span>$-4A\sqrt{I}(1 + 5.0 x 10^{-8}B\sqrt{I})$</span></td></tr><tr><td style="text-align: right"><span>$log \gamma HCO_3\dagger$</span></td><td style="text-align: right">Activity coefficient</td><td style="text-align: right">[-]</td><td style="text-align: right"><span>$-1A\sqrt{I}/(1 + 5.4 x 10^{-8}B\sqrt{I})$</span></td></tr><tr><td style="text-align: right"><span>$log K_1\ddagger$</span></td><td style="text-align: right">Mass balance coefficient</td><td style="text-align: right">[ <span>$mol L^{-1}$</span> ]</td><td style="text-align: right"><span>$-356.3094 - 0.06091964T + 21834.37/T + 126.8339logT - 1684915/T^2$</span></td></tr><tr><td style="text-align: right"><span>$log K_2\ddagger$</span></td><td style="text-align: right">Mass balance coefficient</td><td style="text-align: right">[ <span>$mol L^{-1}$</span> ]</td><td style="text-align: right"><span>$-107.8871 - 0.03252849T + 5151.79/T + 38.92561logT - 563713.9/T^2$</span></td></tr><tr><td style="text-align: right"><span>$log K_c\ddagger$</span></td><td style="text-align: right">Mass balance coefficient</td><td style="text-align: right">[ <span>$mol^2 L^{-2}$</span> ]</td><td style="text-align: right"><span>$-171.9065 - 0.077993T + 2839.319/T + 71.595logT$</span></td></tr><tr><td style="text-align: right"><span>$log K_H\ddagger$</span></td><td style="text-align: right">Mass balance coefficient</td><td style="text-align: right">[ <span>$mol L^{-1} atm^{-1}$</span> ]</td><td style="text-align: right"><span>$108.3865 + 0.01985076T - 6919.53/T - 40.45154logT + 669365/T^2$</span></td></tr></table><p>These parameters are calculated from temperature using the <code>karst_denudation_parameters</code> function:</p><div class="noweb-label">⪡karst-parameter-function⪢≣</div><pre><code class="language- julia hljs">function karst_denudation_parameters(temp::Float64)
    A = -0.4883 + 8.074 * 0.0001 * (temp - 273.0)
    B = -0.3241 + 1.6 * 0.0001 * (temp - 273.0)
    IA = 0.1 # ion activity

    (K1=10^(-356.3094 - 0.06091964 * temp + 21834.37 / temp + 126.8339 * log10(temp) - 1684915 / (temp^2)),
        K2=10^(-107.881 - 0.03252849 * temp + 5151.79 / temp + 38.92561 * log10(temp) - 563713.9 / (temp^2)),
        KC=10^(-171.9065 - 0.077993 * temp + 2839.319 / temp + 71.595 * log10(temp)),
        KH=10^(108.3865 + 0.01985076 * temp - 6919.53 / temp - 40.4515 * log10(temp) + 669365 / (temp^2)),
        activity_Ca=10^(-4A * sqrt(IA) / (1 + 10^(-8) * B * sqrt(IA))),
        activity_Alk=10^(-A * sqrt(IA) / (1 + 5.4 * 10^(-8) * B * sqrt(IA))))
end</code></pre><p>The output of this function for the <span>$K_H$</span> parameter is plotted below for a range of input temperatures</p><p><img src="../../fig/KHTemp.png" alt="KH as function of temperature"/></p><details><summary>Plotting code</summary><div class="noweb-label">file:<i>examples/denudation/dissolution-test.jl</i></div><pre><code class="language- julia hljs">#| requires: examples/denudation/dissolution-test.jl
#| creates:
#|   - docs/src/_fig/KHTemp.png
#|   - docs/src/_fig/Equilibrium_Concs.png
#|   - docs/src/_fig/DissolutionExample.png
#| collect: figures

module DissolutionSpec
using GLMakie
using Unitful
using CarboKitten.Denudation.DissolutionMod: equilibrium, dissolution, karst_denudation_parameters
using CarboKitten: Box
using CarboKitten.Stencil: Periodic, Reflected, stencil


@kwdef struct facies
    infiltration_coefficient :: Float64
    mass_density :: typeof(1.0u&quot;kg/m^3&quot;)
    reactive_surface :: typeof(1.0u&quot;m^2/m^3&quot;)
end


@kwdef struct Dissolution
    temp :: Any
    precip :: Float64
    pco2 :: Float64
    reactionrate :: Float64
end

@kwdef struct state
    ca::Matrix{Int}
end

const BOX = Box{Periodic{2}}(grid_size=(5, 5), phys_scale=1.0u&quot;km&quot;)


const Facies = facies(infiltration_coefficient = 0.5,
mass_density = 2.73u&quot;kg/m^3&quot;,
reactive_surface = 1000u&quot;m^2/m^3&quot;)

const DIS = Dissolution(temp = 285,
precip  = 1.0,
pco2 = 10^(-1.5),
reactionrate = 0.1)

const STATE = state(ca = 
[ 0  0  1  0  0
0  1  0  1  1
0  0  1  0  1
1  0  1  1  0
1  1  1  1  0])

const WD = -10 .* [ 0.0663001  0.115606  0.646196
0.601523   0.130196  0.390821
0.864734   0.902935  0.670354]

function main()
    temp = collect(293:0.5:303)

    Eq_result = Array{Any,1}(undef,length(temp))
    Para_result = Array{Any,1}(undef,length(temp))
    Dis_result = Array{Any,1}(undef,length(temp))
    Dis_result_wd = Array{Any,1}(undef,length(WD))

    for i in eachindex(temp)
        Para_result[i] = karst_denudation_parameters(temp[i])
    end
    Para_result_KH = [x.KH for x in Para_result]

    for i in eachindex(temp)
       Eq_result[i] =  equilibrium(temp[i],DIS.pco2,DIS.precip,Facies)
    end
    Eq_result_concs = [x.concentration for x in Eq_result]
    for i in eachindex(temp)
        Dis_result[i] = dissolution(temp[i],DIS.precip,DIS.pco2,DIS.reactionrate,WD[1],Facies)
    end
    Dis_result
    for i in eachindex(WD)
        Dis_result_wd[i] = dissolution(temp[1],DIS.precip,DIS.pco2,DIS.reactionrate,WD[i],Facies)
    end
    Dis_result_wd

    fig1 = Figure()
    ax1 = Axis(fig1[1,1],xlabel=&quot;Temp (K)&quot;, ylabel=&quot; concentration (mol/L)&quot;)
    lines!(ax1,temp,Eq_result_concs)
    save(&quot;docs/src/_fig/Equilibrium_Concs.png&quot;,fig1)

    fig2 = Figure()
    ax2 = Axis(fig2[1,1],xlabel=&quot;Temp (K)&quot;, ylabel=&quot;KH&quot;)
    lines!(ax2,temp,Para_result_KH)
    save(&quot;docs/src/_fig/KHTemp.png&quot;,fig2)

    fig3 = Figure()
    ax3 = Axis(fig3[1,1],xlabel=&quot;Temp (K)&quot;, ylabel=&quot;Denudation rates (m/Myr)&quot;)
    lines!(ax3,temp,Dis_result)

    ax4 = Axis(fig3[1,2],xlabel=&quot;Water Depth (m)&quot;, ylabel=&quot;Denudation rates (m/Myr)&quot;)
    scatter!(ax4,vec(WD),Dis_result_wd)
    fig3
    save(&quot;docs/src/_fig/DissolutionExample.png&quot;,fig3)
end
end

DissolutionSpec.main()</code></pre></details><p>The <span>$[Ca^{2+}]_{eq}$</span> parameter is calculated from temperature using the <code>equilibrium</code> function:</p><div class="noweb-label">⪡karst-equilibrium-function⪢≣</div><pre><code class="language- julia hljs">function equilibrium(temp::Float64, pco2::Float64, precip::Float64, facies)
    p = karst_denudation_parameters(temp)
    mass_density = facies.mass_density ./ u&quot;kg/m^3&quot;
    eq_c = (pco2 .* (p.K1 * p.KC * p.KH) ./ (4 * p.K2 * p.activity_Ca .* (p.activity_Alk)^2)) .^ (1 / 3)
    eq_d = 1e6 * precip .* facies.infiltration_coefficient * 40 * 1000 .* eq_c ./ mass_density
    (concentration=eq_c, denudation=eq_d)
end</code></pre><p>The value of <span>$[Ca^{2+}]_{eq}$</span> calculated in <code>equilibrium</code> for a range of temperatures: <img src="../../fig/Equilibrium_Concs.png" alt="KH as function of temperature"/></p><p>However, the above discussion is true only if the percolated fluid is saturated (in terms of Ca) when leaving the platform. In some cases, when the fluid is not saturated, the dissolved amount is lower than the scenario described above.</p><p>The following articles describe this: [<a href="../../references/#gabrovsek_concepts_2009">12</a>] and [<a href="../../references/#kaufmann_calcite_2007">13</a>]</p><p>Ideally, a reactive transport model should be accurate, but that needs more computation resources. So herein, the author just suggested the dissolution rates of rocks depend on the depth. This makes sense, as the deeper the solution penetrates, the more concentrated it becomes. Also, this does not consider diffusion in this chapter.</p><p>The dissolution rate of carbonate follows linear rate laws of:</p><p class="math-container">\[F = \alpha (c_{eq}-c(z))\]</p><p>The rate law is a common expression way to describe the kinetics of certain chemical reactions <a href="https://en.wikipedia.org/wiki/Rate_equation">see Rate Laws</a>.</p><p class="math-container">\[F\]</p><p>is the dissolution rate, <span>$\alpha$</span> is constant (kinetic co-efficient), <span>$c_{eq}$</span> is the concentration in fluid when equilibrium is reached (i.e., no more dissolution, which is <span>$[Ca^{2+}]_{eq}$</span> in Chapter 1), <span>$c(z)$</span> is the current concentrationion at depth <span>$z$</span> in the fluid. This equation then expands to</p><p class="math-container">\[I\ {\rm d}c = \alpha (c_{eq}-c(z)) L\ {\rm d}z\]</p><p>This equation indicates that the concentration increase in the infiltrated water equals the dissolution of rocks in the thickness of <span>$dz$</span>. <span>$L$</span> is the specific length of fractures/porosities (units: <span>$m/m^2$</span>, we can try 100 at the first place). I.e., this term defines the relative reactive surface of the subsurface rocks, or how much surface is actually dissolving. This term is difficult to determine. <span>$I$</span> is infiltration, but slightly different as chapter 1: this <span>$I$</span> is the <span>$I$</span> in each rain event according to the paper. We certainly do not gonna know how this parameter works, so we just set it the same as in chapter 1?</p><p>However, to solve this equation we still need to know <span>$c(z)$</span>.</p><p>If assuming the initial percolating water has <span>$c(0) = 0$</span>, then we could get the following equation (as <span>$c$</span> is related to depth):</p><p class="math-container">\[c(z) = c_{eq}\ (1 - e^{(-z/\lambda)})\]</p><p>Herein, $ \lambda = {{I} \over {\alpha L}} $.</p><p>Therefore,</p><p class="math-container">\[D_{\rm average} = (I\times \frac{c_{eq}}{\rho})\ (1 – (\frac{\lambda}{z_0})\ (1 – e^{(\frac{-z_0}{\lambda})}))\]</p><p>α used in this article is <span>$\alpha = 2·10^{−6}$</span> or <span>$3.5·10^{−7}$</span> cm/s (for temp at 298K). This is indeed a controversial parameter TBH. We can try different values and see what happens.</p><p>These equations are implemented as <code>dissolution</code> function:</p><div class="noweb-label">⪡karst-dissolution-function⪢≣</div><pre><code class="language- julia hljs">function dissolution(temp, precip, pco2, alpha, water_depth, facies)
    reactive_surface =  facies.reactive_surface ./u&quot;m^2/m^3&quot;
    λ = precip * 100 .* facies.infiltration_coefficient ./ (alpha .* reactive_surface)
    eq = equilibrium(temp, pco2, precip, facies) # pass ceq Deq from the last function
    eq.denudation .* (1 - (λ ./ -water_depth) .* (1 - exp.(water_depth ./ λ))) * u&quot;m/Myr&quot;
end</code></pre><p>The dedudation rate calculated in this function for varying temperature and water depth is plotted here:</p><p><img src="../../fig/DissolutionExample.png" alt="Dissolution as function of temperature and water depth"/></p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><div class="noweb-label">file:<i>src/Denudation/DissolutionMod.jl</i></div><pre><code class="language- julia hljs">module DissolutionMod

import ..Abstract: DenudationType, denudation, redistribution
using ...BoundaryTrait: Boundary
using ...Boxes: Box
export Dissolution
using Unitful

@kwdef struct Dissolution &lt;: DenudationType
    temp::typeof(1.0u&quot;K&quot;)
    precip::typeof(1.0u&quot;m&quot;)
    pco2::typeof(1.0u&quot;atm&quot;)
    reactionrate::typeof(1.0u&quot;m/yr&quot;)
end

&lt;&lt;karst-parameter-function&gt;&gt;

#calculate ceq and Deq, Kaufman 2002
&lt;&lt;karst-equilibrium-function&gt;&gt;

&lt;&lt;karst-dissolution-function&gt;&gt;


function denudation(::Box{BT}, p::Dissolution, water_depth, slope, facies, state) where {BT&lt;:Boundary}
    temp = p.temp ./ u&quot;K&quot;
    precip = p.precip ./u&quot;m&quot;
    pco2 = p.pco2 ./1.0u&quot;atm&quot;
    reactionrate = p.reactionrate ./u&quot;m/yr&quot;
    denudation_rate = zeros(typeof(1.0u&quot;m/Myr&quot;), length(facies), size(state.ca)...)

    for idx in CartesianIndices(state.ca)
        f = state.ca[idx]
        if f == 0
            continue
        end
        if water_depth[idx] &lt;= 0
            denudation_rate[f, idx] = dissolution(temp, precip, pco2, reactionrate, water_depth[idx], facies[f])
        end
    end
    return denudation_rate
end

function redistribution(box::Box{BT}, p::Dissolution, denudation_mass, water_depth) where {BT&lt;:Boundary}
    return nothing
end

end</code></pre><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../empirical/">« Empirical Denudation</a><a class="docs-footer-nextpage" href="../physical_erosion/">Physical Erosion »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 24 March 2025 10:07">Monday 24 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
