<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ALCAPS · CarboKitten</title><meta name="title" content="ALCAPS · CarboKitten"/><meta property="og:title" content="ALCAPS · CarboKitten"/><meta property="twitter:title" content="ALCAPS · CarboKitten"/><meta name="description" content="Documentation for CarboKitten."/><meta property="og:description" content="Documentation for CarboKitten."/><meta property="twitter:description" content="Documentation for CarboKitten."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CarboKitten</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../bosscher-1992/">Bosscher and Schlager 1992</a></li><li><a class="tocitem" href="../ca-with-production/">Model with CA and Production</a></li><li class="is-active"><a class="tocitem" href>ALCAPS</a><ul class="internal"><li><a class="tocitem" href="#Example-Input"><span>Example Input</span></a></li><li><a class="tocitem" href="#Modular-Implementation"><span>Modular Implementation</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../first_tutorial/">Tutorial (Pluto notebook)</a></li><li><a class="tocitem" href="../cases/tabular-sea-level/">Tabular Sea Levels</a></li></ul></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><span class="tocitem">Model Components</span><ul><li><a class="tocitem" href="../components/components/">Components</a></li><li><a class="tocitem" href="../components/tag/">Tags</a></li><li><a class="tocitem" href="../components/boxes/">Boxes</a></li><li><a class="tocitem" href="../components/time/">Time</a></li><li><a class="tocitem" href="../components/facies/">Facies</a></li><li><a class="tocitem" href="../components/cellular-automata/">Cellular Automata</a></li><li><a class="tocitem" href="../components/waterdepth/">Water Depth</a></li><li><a class="tocitem" href="../components/production/">Production</a></li><li><a class="tocitem" href="../components/hdf5/">HDF5 Writer</a></li><li><a class="tocitem" href="../components/sediment_buffer/">Sediment Buffers</a></li><li><a class="tocitem" href="../active-layer-transport/">Active Layer Transport</a></li><li><a class="tocitem" href="../onshore-transport/">Onshore Transport</a></li></ul></li><li><a class="tocitem" href="../visualization/">Visualizations</a></li><li><span class="tocitem">CarboCAT</span><ul><li><a class="tocitem" href="../carbocat/">Summary</a></li></ul></li><li><span class="tocitem">Denudation</span><ul><li><a class="tocitem" href="../denudation/denudation/">Denudation</a></li><li><a class="tocitem" href="../denudation/empirical/">Empirical Denudation</a></li><li><a class="tocitem" href="../denudation/chemical/">Chemical Dissolution</a></li><li><a class="tocitem" href="../denudation/physical_erosion/">Physical Erosion</a></li></ul></li><li><span class="tocitem">Output</span><ul><li><a class="tocitem" href="../data-export/">CSV Export</a></li></ul></li><li><span class="tocitem">Algorithms</span><ul><li><a class="tocitem" href="../unitful/">Unitful</a></li><li><a class="tocitem" href="../boxes/">Boxes</a></li><li><a class="tocitem" href="../stencils/">Stencils</a></li><li><a class="tocitem" href="../utility/">Utility</a></li></ul></li><li><a class="tocitem" href="../api/">API Documentation</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>ALCAPS</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ALCAPS</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MindTheGap-ERC/CarboKitten.jl/blob/main/docs/transpiled/model-alcap.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Model-with-CA,-Production-and-Active-Layer-transport-(ALCAP)"><a class="docs-heading-anchor" href="#Model-with-CA,-Production-and-Active-Layer-transport-(ALCAP)">Model with CA, Production and Active Layer transport (ALCAP)</a><a id="Model-with-CA,-Production-and-Active-Layer-transport-(ALCAP)-1"></a><a class="docs-heading-anchor-permalink" href="#Model-with-CA,-Production-and-Active-Layer-transport-(ALCAP)" title="Permalink"></a></h1><p>The following <strong>S</strong>edimentation model includes the Burgess 2013 <strong>C</strong>ellular <strong>A</strong>utomaton, Bosscher &amp; Schlager 1992 <strong>P</strong>roduction curves and an <strong>A</strong>ctive <strong>L</strong>ayer transport model, based on Paola 1992, henceforth ALCAP.</p><p><img src="../fig/alcaps-alternative.png" alt="Result from alternative input"/></p><h2 id="Example-Input"><a class="docs-heading-anchor" href="#Example-Input">Example Input</a><a id="Example-Input-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Input" title="Permalink"></a></h2><p>The following is a complete example input.</p><div class="noweb-label">⪡alcap-example-input⪢≣</div><pre><code class="language- julia hljs">const TAG = &quot;alcap-example&quot;

const FACIES = [
    ALCAP.Facies(
        viability_range=(4, 10),
        activation_range=(6, 10),
        maximum_growth_rate=500u&quot;m/Myr&quot;,
        extinction_coefficient=0.8u&quot;m^-1&quot;,
        saturation_intensity=60u&quot;W/m^2&quot;,
        diffusion_coefficient=50.0u&quot;m/yr&quot;),
    ALCAP.Facies(
        viability_range=(4, 10),
        activation_range=(6, 10),
        maximum_growth_rate=400u&quot;m/Myr&quot;,
        extinction_coefficient=0.1u&quot;m^-1&quot;,
        saturation_intensity=60u&quot;W/m^2&quot;,
        diffusion_coefficient=25.0u&quot;m/yr&quot;),
    ALCAP.Facies(
        viability_range=(4, 10),
        activation_range=(6, 10),
        maximum_growth_rate=100u&quot;m/Myr&quot;,
        extinction_coefficient=0.005u&quot;m^-1&quot;,
        saturation_intensity=60u&quot;W/m^2&quot;,
        diffusion_coefficient=12.5u&quot;m/yr&quot;)
]

const PERIOD = 0.2u&quot;Myr&quot;
const AMPLITUDE = 4.0u&quot;m&quot;

const INPUT = ALCAP.Input(
    tag=&quot;$TAG&quot;,
    box=Box{Coast}(grid_size=(100, 50), phys_scale=150.0u&quot;m&quot;),
    time=TimeProperties(
        Δt=0.0002u&quot;Myr&quot;,
        steps=5000,
        write_interval=1),
    ca_interval=1,
    initial_topography=(x, y) -&gt; -x / 300.0,
    sea_level=t -&gt; AMPLITUDE * sin(2π * t / PERIOD),
    subsidence_rate=50.0u&quot;m/Myr&quot;,
    disintegration_rate=50.0u&quot;m/Myr&quot;,
    insolation=400.0u&quot;W/m^2&quot;,
    sediment_buffer_size=50,
    depositional_resolution=0.5u&quot;m&quot;,
    facies=FACIES)</code></pre><div class="noweb-label">file:<i>examples/model/alcap/run.jl</i></div><pre><code class="language- julia hljs">#| requires: src/Models/ALCAP.jl
#| creates: data/output/alcap-example.h5

module Script

using Unitful
using CarboKitten
using CarboKitten.Export: data_export, CSV

const PATH = &quot;data/output&quot;

&lt;&lt;alcap-example-input&gt;&gt;

function main()
    run_model(Model{ALCAP}, INPUT, &quot;$(PATH)/$(TAG).h5&quot;)

    data_export(
        CSV(tuple.(10:20:70, 25),
            :sediment_accumulation_curve =&gt; &quot;$(PATH)/$(TAG)_sac.csv&quot;,
            :age_depth_model =&gt; &quot;$(PATH)/$(TAG)_adm.csv&quot;,
            :stratigraphic_column =&gt; &quot;$(PATH)/$(TAG)_sc.csv&quot;,
            :water_depth =&gt; &quot;$(PATH)/$(TAG)_wd.csv&quot;,
            :metadata =&gt; &quot;$(PATH)/$(TAG).toml&quot;),
        &quot;$(PATH)/$(TAG).h5&quot;)
end

end

Script.main()</code></pre><details><summary>Plotting code</summary><div class="noweb-label">file:<i>examples/model/alcap/plot.jl</i></div><pre><code class="language- julia hljs">#| creates: docs/src/_fig/alcaps-alternative.png
#| requires: data/output/alcap-example.h5
#| collect: figures

using GLMakie
using CarboKitten.Visualization

save(&quot;docs/src/_fig/alcaps-alternative.png&quot;, summary_plot(&quot;data/output/alcap-example.h5&quot;))</code></pre></details><h2 id="Modular-Implementation"><a class="docs-heading-anchor" href="#Modular-Implementation">Modular Implementation</a><a id="Modular-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Modular-Implementation" title="Permalink"></a></h2><div class="component-dag" style="overflow: scroll"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Pages: 1 -->
<svg width="1116pt" height="580pt"
 viewBox="0.00 0.00 1115.50 580.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 576)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-576 1111.5,-576 1111.5,4 -4,4"/>
<!-- Boxes -->
<g id="node1" class="node">
<title>Boxes</title>
<path fill="none" stroke="black" d="M630,-572C630,-572 492,-572 492,-572 486,-572 480,-566 480,-560 480,-560 480,-505 480,-505 480,-499 486,-493 492,-493 492,-493 630,-493 630,-493 636,-493 642,-499 642,-505 642,-505 642,-560 642,-560 642,-566 636,-572 630,-572"/>
<polyline fill="none" stroke="black" points="487,-541.5 635,-541.5 "/>
<text text-anchor="start" x="537.5" y="-550.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Boxes</text>
<polygon fill="#cccccc" stroke="transparent" points="487,-518.5 487,-541.5 534,-541.5 534,-518.5 487,-518.5"/>
<polyline fill="none" stroke="black" points="487,-518.5 534,-518.5 534,-541.5 487,-541.5 "/>
<text text-anchor="start" x="491" y="-526.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="534,-518.5 534,-541.5 588,-541.5 588,-518.5 534,-518.5"/>
<polygon fill="none" stroke="black" points="534,-518.5 534,-541.5 588,-541.5 588,-518.5 534,-518.5"/>
<text text-anchor="start" x="538" y="-526.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="588,-518.5 588,-541.5 635,-541.5 635,-518.5 588,-518.5"/>
<polyline fill="none" stroke="black" points="635,-541.5 588,-541.5 588,-518.5 635,-518.5 "/>
<text text-anchor="start" x="592" y="-526.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="534,-499.5 534,-518.5 "/>
<text text-anchor="start" x="491" y="-506.5" font-family="monospace" font-size="10.00">box</text>
<polyline fill="none" stroke="black" points="588,-499.5 588,-518.5 "/>
<text text-anchor="start" x="538" y="-506.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="591" y="-506.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- WaterDepth -->
<g id="node3" class="node">
<title>WaterDepth</title>
<path fill="none" stroke="black" d="M600,-457C600,-457 342,-457 342,-457 336,-457 330,-451 330,-445 330,-445 330,-352 330,-352 330,-346 336,-340 342,-340 342,-340 600,-340 600,-340 606,-340 612,-346 612,-352 612,-352 612,-445 612,-445 612,-451 606,-457 600,-457"/>
<polyline fill="none" stroke="black" points="337,-426.5 605,-426.5 "/>
<text text-anchor="start" x="423.5" y="-435.3" font-family="Times,serif" font-weight="bold" font-size="14.00">WaterDepth</text>
<polygon fill="#cccccc" stroke="transparent" points="337,-403.5 337,-426.5 454,-426.5 454,-403.5 337,-403.5"/>
<polyline fill="none" stroke="black" points="337,-403.5 454,-403.5 454,-426.5 337,-426.5 "/>
<text text-anchor="start" x="341" y="-411.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="454,-403.5 454,-426.5 508,-426.5 508,-403.5 454,-403.5"/>
<polygon fill="none" stroke="black" points="454,-403.5 454,-426.5 508,-426.5 508,-403.5 454,-403.5"/>
<text text-anchor="start" x="458" y="-411.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="508,-403.5 508,-426.5 605,-426.5 605,-403.5 508,-403.5"/>
<polyline fill="none" stroke="black" points="605,-426.5 508,-426.5 508,-403.5 605,-403.5 "/>
<text text-anchor="start" x="512" y="-411.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="454,-384.5 454,-403.5 "/>
<text text-anchor="start" x="341" y="-391.5" font-family="monospace" font-size="10.00">sea_level</text>
<polyline fill="none" stroke="black" points="508,-384.5 508,-403.5 "/>
<text text-anchor="start" x="458" y="-391.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="511" y="-391.5" font-family="monospace" font-size="10.00">sediment_height</text>
<polyline fill="none" stroke="black" points="454,-365.5 454,-384.5 "/>
<text text-anchor="start" x="341" y="-372.5" font-family="monospace" font-size="10.00">initial_topography</text>
<polyline fill="none" stroke="black" points="508,-365.5 508,-384.5 "/>
<text text-anchor="start" x="458" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="511" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="454,-346.5 454,-365.5 "/>
<text text-anchor="start" x="341" y="-353.5" font-family="monospace" font-size="10.00">subsidence_rate</text>
<polyline fill="none" stroke="black" points="508,-346.5 508,-365.5 "/>
<text text-anchor="start" x="458" y="-353.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="511" y="-353.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Boxes&#45;&gt;WaterDepth -->
<g id="edge2" class="edge">
<title>Boxes&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M534.73,-492.97C528.93,-484.46 522.62,-475.21 516.31,-465.95"/>
<polygon fill="black" stroke="black" points="519.05,-463.76 510.52,-457.47 513.27,-467.7 519.05,-463.76"/>
</g>
<!-- SedimentBuffer -->
<g id="node6" class="node">
<title>SedimentBuffer</title>
<path fill="none" stroke="black" d="M300,-447.5C300,-447.5 12,-447.5 12,-447.5 6,-447.5 0,-441.5 0,-435.5 0,-435.5 0,-361.5 0,-361.5 0,-355.5 6,-349.5 12,-349.5 12,-349.5 300,-349.5 300,-349.5 306,-349.5 312,-355.5 312,-361.5 312,-361.5 312,-435.5 312,-435.5 312,-441.5 306,-447.5 300,-447.5"/>
<polyline fill="none" stroke="black" points="7,-417.5 305,-417.5 "/>
<text text-anchor="start" x="93" y="-426.3" font-family="Times,serif" font-weight="bold" font-size="14.00">SedimentBuffer</text>
<polygon fill="#cccccc" stroke="transparent" points="7,-394.5 7,-417.5 154,-417.5 154,-394.5 7,-394.5"/>
<polyline fill="none" stroke="black" points="7,-394.5 154,-394.5 154,-417.5 7,-417.5 "/>
<text text-anchor="start" x="11" y="-402.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="154,-394.5 154,-417.5 208,-417.5 208,-394.5 154,-394.5"/>
<polygon fill="none" stroke="black" points="154,-394.5 154,-417.5 208,-417.5 208,-394.5 154,-394.5"/>
<text text-anchor="start" x="158" y="-402.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="208,-394.5 208,-417.5 305,-417.5 305,-394.5 208,-394.5"/>
<polyline fill="none" stroke="black" points="305,-417.5 208,-417.5 208,-394.5 305,-394.5 "/>
<text text-anchor="start" x="212" y="-402.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="154,-375.5 154,-394.5 "/>
<text text-anchor="start" x="11" y="-382.5" font-family="monospace" font-size="10.00">sediment_buffer_size</text>
<polyline fill="none" stroke="black" points="208,-375.5 208,-394.5 "/>
<text text-anchor="start" x="158" y="-382.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="211" y="-382.5" font-family="monospace" font-size="10.00">sediment_buffer</text>
<polyline fill="none" stroke="black" points="154,-356.5 154,-375.5 "/>
<text text-anchor="start" x="11" y="-363.5" font-family="monospace" font-size="10.00">depositional_resolution</text>
<polyline fill="none" stroke="black" points="208,-356.5 208,-375.5 "/>
<text text-anchor="start" x="158" y="-363.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="211" y="-363.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Boxes&#45;&gt;SedimentBuffer -->
<g id="edge10" class="edge">
<title>Boxes&#45;&gt;SedimentBuffer</title>
<path fill="none" stroke="black" d="M479.8,-496.04C476.84,-494.98 473.9,-493.96 471,-493 405.92,-471.44 386.79,-476.3 321,-457 314.1,-454.97 307.05,-452.83 299.96,-450.61"/>
<polygon fill="black" stroke="black" points="300.85,-447.22 290.26,-447.53 298.74,-453.89 300.85,-447.22"/>
</g>
<!-- CellularAutomaton -->
<g id="node10" class="node">
<title>CellularAutomaton</title>
<path fill="none" stroke="black" d="M1095.5,-294.5C1095.5,-294.5 834.5,-294.5 834.5,-294.5 828.5,-294.5 822.5,-288.5 822.5,-282.5 822.5,-282.5 822.5,-208.5 822.5,-208.5 822.5,-202.5 828.5,-196.5 834.5,-196.5 834.5,-196.5 1095.5,-196.5 1095.5,-196.5 1101.5,-196.5 1107.5,-202.5 1107.5,-208.5 1107.5,-208.5 1107.5,-282.5 1107.5,-282.5 1107.5,-288.5 1101.5,-294.5 1095.5,-294.5"/>
<polyline fill="none" stroke="black" points="830,-264.5 1101,-264.5 "/>
<text text-anchor="start" x="890" y="-273.3" font-family="Times,serif" font-weight="bold" font-size="14.00">CellularAutomaton</text>
<polygon fill="#cccccc" stroke="transparent" points="830,-241.5 830,-264.5 923,-264.5 923,-241.5 830,-241.5"/>
<polyline fill="none" stroke="black" points="830,-241.5 923,-241.5 923,-264.5 830,-264.5 "/>
<text text-anchor="start" x="834" y="-249.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="923,-241.5 923,-264.5 1028,-264.5 1028,-241.5 923,-241.5"/>
<polygon fill="none" stroke="black" points="923,-241.5 923,-264.5 1028,-264.5 1028,-241.5 923,-241.5"/>
<text text-anchor="start" x="927" y="-249.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="1028,-241.5 1028,-264.5 1101,-264.5 1101,-241.5 1028,-241.5"/>
<polyline fill="none" stroke="black" points="1101,-264.5 1028,-264.5 1028,-241.5 1101,-241.5 "/>
<text text-anchor="start" x="1032" y="-249.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="923,-222.5 923,-241.5 "/>
<text text-anchor="start" x="834" y="-229.5" font-family="monospace" font-size="10.00">ca_interval</text>
<polyline fill="none" stroke="black" points="1028,-222.5 1028,-241.5 "/>
<text text-anchor="start" x="927" y="-229.5" font-family="monospace" font-size="10.00">viability_range</text>
<text text-anchor="start" x="1031" y="-229.5" font-family="monospace" font-size="10.00">ca</text>
<polyline fill="none" stroke="black" points="923,-203.5 923,-222.5 "/>
<text text-anchor="start" x="834" y="-210.5" font-family="monospace" font-size="10.00">ca_random_seed</text>
<polyline fill="none" stroke="black" points="1028,-203.5 1028,-222.5 "/>
<text text-anchor="start" x="927" y="-210.5" font-family="monospace" font-size="10.00">activation_range</text>
<text text-anchor="start" x="1031" y="-210.5" font-family="monospace" font-size="10.00">ca_priority</text>
</g>
<!-- Boxes&#45;&gt;CellularAutomaton -->
<g id="edge17" class="edge">
<title>Boxes&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M642.04,-519.05C691.3,-508.54 753.63,-489.75 801,-457 858.58,-417.19 905.32,-351.04 933.96,-303.52"/>
<polygon fill="black" stroke="black" points="937,-305.26 939.09,-294.87 930.98,-301.68 937,-305.26"/>
</g>
<!-- TimeIntegration -->
<g id="node2" class="node">
<title>TimeIntegration</title>
<path fill="none" stroke="black" d="M450,-572C450,-572 312,-572 312,-572 306,-572 300,-566 300,-560 300,-560 300,-505 300,-505 300,-499 306,-493 312,-493 312,-493 450,-493 450,-493 456,-493 462,-499 462,-505 462,-505 462,-560 462,-560 462,-566 456,-572 450,-572"/>
<polyline fill="none" stroke="black" points="307,-541.5 455,-541.5 "/>
<text text-anchor="start" x="315.5" y="-550.3" font-family="Times,serif" font-weight="bold" font-size="14.00">TimeIntegration</text>
<polygon fill="#cccccc" stroke="transparent" points="307,-518.5 307,-541.5 354,-541.5 354,-518.5 307,-518.5"/>
<polyline fill="none" stroke="black" points="307,-518.5 354,-518.5 354,-541.5 307,-541.5 "/>
<text text-anchor="start" x="311" y="-526.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="354,-518.5 354,-541.5 408,-541.5 408,-518.5 354,-518.5"/>
<polygon fill="none" stroke="black" points="354,-518.5 354,-541.5 408,-541.5 408,-518.5 354,-518.5"/>
<text text-anchor="start" x="358" y="-526.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="408,-518.5 408,-541.5 455,-541.5 455,-518.5 408,-518.5"/>
<polyline fill="none" stroke="black" points="455,-541.5 408,-541.5 408,-518.5 455,-518.5 "/>
<text text-anchor="start" x="412" y="-526.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="354,-499.5 354,-518.5 "/>
<text text-anchor="start" x="311" y="-506.5" font-family="monospace" font-size="10.00">time</text>
<polyline fill="none" stroke="black" points="408,-499.5 408,-518.5 "/>
<text text-anchor="start" x="358" y="-506.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="411" y="-506.5" font-family="monospace" font-size="10.00">step</text>
</g>
<!-- TimeIntegration&#45;&gt;WaterDepth -->
<g id="edge1" class="edge">
<title>TimeIntegration&#45;&gt;WaterDepth</title>
<path fill="none" stroke="black" d="M407.27,-492.97C413.07,-484.46 419.38,-475.21 425.69,-465.95"/>
<polygon fill="black" stroke="black" points="428.73,-467.7 431.48,-457.47 422.95,-463.76 428.73,-467.7"/>
</g>
<!-- ActiveLayer -->
<g id="node4" class="node">
<title>ActiveLayer</title>
<path fill="none" stroke="black" d="M396.5,-285C396.5,-285 101.5,-285 101.5,-285 95.5,-285 89.5,-279 89.5,-273 89.5,-273 89.5,-218 89.5,-218 89.5,-212 95.5,-206 101.5,-206 101.5,-206 396.5,-206 396.5,-206 402.5,-206 408.5,-212 408.5,-218 408.5,-218 408.5,-273 408.5,-273 408.5,-279 402.5,-285 396.5,-285"/>
<polyline fill="none" stroke="black" points="97,-254.5 402,-254.5 "/>
<text text-anchor="start" x="203.5" y="-263.3" font-family="Times,serif" font-weight="bold" font-size="14.00">ActiveLayer</text>
<polygon fill="#cccccc" stroke="transparent" points="97,-231.5 97,-254.5 220,-254.5 220,-231.5 97,-231.5"/>
<polyline fill="none" stroke="black" points="97,-231.5 220,-231.5 220,-254.5 97,-254.5 "/>
<text text-anchor="start" x="101" y="-239.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="220,-231.5 220,-254.5 355,-254.5 355,-231.5 220,-231.5"/>
<polygon fill="none" stroke="black" points="220,-231.5 220,-254.5 355,-254.5 355,-231.5 220,-231.5"/>
<text text-anchor="start" x="224" y="-239.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="355,-231.5 355,-254.5 402,-254.5 402,-231.5 355,-231.5"/>
<polyline fill="none" stroke="black" points="402,-254.5 355,-254.5 355,-231.5 402,-231.5 "/>
<text text-anchor="start" x="359" y="-239.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="220,-212.5 220,-231.5 "/>
<text text-anchor="start" x="101" y="-219.5" font-family="monospace" font-size="10.00">disintegration_rate</text>
<polyline fill="none" stroke="black" points="355,-212.5 355,-231.5 "/>
<text text-anchor="start" x="224" y="-219.5" font-family="monospace" font-size="10.00">diffusion_coefficient</text>
<text text-anchor="start" x="358" y="-219.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- WaterDepth&#45;&gt;ActiveLayer -->
<g id="edge3" class="edge">
<title>WaterDepth&#45;&gt;ActiveLayer</title>
<path fill="none" stroke="black" d="M386.44,-339.98C362.53,-323.72 336.89,-306.28 314.31,-290.92"/>
<polygon fill="black" stroke="black" points="316.05,-287.87 305.81,-285.14 312.11,-293.66 316.05,-287.87"/>
</g>
<!-- H5Writer -->
<g id="node7" class="node">
<title>H5Writer</title>
<path fill="none" stroke="black" d="M503.5,-263.5C503.5,-263.5 438.5,-263.5 438.5,-263.5 432.5,-263.5 426.5,-257.5 426.5,-251.5 426.5,-251.5 426.5,-239.5 426.5,-239.5 426.5,-233.5 432.5,-227.5 438.5,-227.5 438.5,-227.5 503.5,-227.5 503.5,-227.5 509.5,-227.5 515.5,-233.5 515.5,-239.5 515.5,-239.5 515.5,-251.5 515.5,-251.5 515.5,-257.5 509.5,-263.5 503.5,-263.5"/>
<text text-anchor="start" x="433.5" y="-242.8" font-family="Times,serif" font-weight="bold" font-size="14.00">H5Writer</text>
</g>
<!-- WaterDepth&#45;&gt;H5Writer -->
<g id="edge7" class="edge">
<title>WaterDepth&#45;&gt;H5Writer</title>
<path fill="none" stroke="black" d="M471,-339.98C471,-317.27 471,-292.25 471,-273.82"/>
<polygon fill="black" stroke="black" points="474.5,-273.79 471,-263.79 467.5,-273.79 474.5,-273.79"/>
</g>
<!-- Production -->
<g id="node8" class="node">
<title>Production</title>
<path fill="none" stroke="black" d="M792.5,-304C792.5,-304 545.5,-304 545.5,-304 539.5,-304 533.5,-298 533.5,-292 533.5,-292 533.5,-199 533.5,-199 533.5,-193 539.5,-187 545.5,-187 545.5,-187 792.5,-187 792.5,-187 798.5,-187 804.5,-193 804.5,-199 804.5,-199 804.5,-292 804.5,-292 804.5,-298 798.5,-304 792.5,-304"/>
<polyline fill="none" stroke="black" points="541,-273.5 798,-273.5 "/>
<text text-anchor="start" x="625.5" y="-282.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Production</text>
<polygon fill="#cccccc" stroke="transparent" points="541,-250.5 541,-273.5 610,-273.5 610,-250.5 541,-250.5"/>
<polyline fill="none" stroke="black" points="541,-250.5 610,-250.5 610,-273.5 541,-273.5 "/>
<text text-anchor="start" x="545" y="-258.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="610,-250.5 610,-273.5 751,-273.5 751,-250.5 610,-250.5"/>
<polygon fill="none" stroke="black" points="610,-250.5 610,-273.5 751,-273.5 751,-250.5 610,-250.5"/>
<text text-anchor="start" x="614" y="-258.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="751,-250.5 751,-273.5 798,-273.5 798,-250.5 751,-250.5"/>
<polyline fill="none" stroke="black" points="798,-273.5 751,-273.5 751,-250.5 798,-250.5 "/>
<text text-anchor="start" x="755" y="-258.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="610,-231.5 610,-250.5 "/>
<text text-anchor="start" x="545" y="-238.5" font-family="monospace" font-size="10.00">insolation</text>
<polyline fill="none" stroke="black" points="751,-231.5 751,-250.5 "/>
<text text-anchor="start" x="614" y="-238.5" font-family="monospace" font-size="10.00">maximum_growth_rate</text>
<text text-anchor="start" x="754" y="-238.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="610,-212.5 610,-231.5 "/>
<text text-anchor="start" x="545" y="-219.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="751,-212.5 751,-231.5 "/>
<text text-anchor="start" x="614" y="-219.5" font-family="monospace" font-size="10.00">extinction_coefficient</text>
<text text-anchor="start" x="754" y="-219.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="610,-193.5 610,-212.5 "/>
<text text-anchor="start" x="545" y="-200.5" font-family="monospace" font-size="10.00"> </text>
<polyline fill="none" stroke="black" points="751,-193.5 751,-212.5 "/>
<text text-anchor="start" x="614" y="-200.5" font-family="monospace" font-size="10.00">saturation_intensity</text>
<text text-anchor="start" x="754" y="-200.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- WaterDepth&#45;&gt;Production -->
<g id="edge8" class="edge">
<title>WaterDepth&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M546.42,-339.98C559.18,-330.25 572.5,-320.1 585.45,-310.22"/>
<polygon fill="black" stroke="black" points="587.63,-312.95 593.46,-304.11 583.39,-307.39 587.63,-312.95"/>
</g>
<!-- ALCAP -->
<g id="node12" class="node">
<title>ALCAP</title>
<path fill="none" stroke="black" d="M564.5,-36C564.5,-36 521.5,-36 521.5,-36 515.5,-36 509.5,-30 509.5,-24 509.5,-24 509.5,-12 509.5,-12 509.5,-6 515.5,0 521.5,0 521.5,0 564.5,0 564.5,0 570.5,0 576.5,-6 576.5,-12 576.5,-12 576.5,-24 576.5,-24 576.5,-30 570.5,-36 564.5,-36"/>
<text text-anchor="start" x="516.5" y="-15.3" font-family="Times,serif" font-weight="bold" font-size="14.00">ALCAP</text>
</g>
<!-- ActiveLayer&#45;&gt;ALCAP -->
<g id="edge16" class="edge">
<title>ActiveLayer&#45;&gt;ALCAP</title>
<path fill="none" stroke="black" d="M299.21,-205.99C360.45,-159.02 462.03,-81.11 512.54,-42.36"/>
<polygon fill="black" stroke="black" points="514.97,-44.91 520.77,-36.05 510.71,-39.36 514.97,-44.91"/>
</g>
<!-- FaciesBase -->
<g id="node5" class="node">
<title>FaciesBase</title>
<path fill="none" stroke="black" d="M780,-438C780,-438 642,-438 642,-438 636,-438 630,-432 630,-426 630,-426 630,-371 630,-371 630,-365 636,-359 642,-359 642,-359 780,-359 780,-359 786,-359 792,-365 792,-371 792,-371 792,-426 792,-426 792,-432 786,-438 780,-438"/>
<polyline fill="none" stroke="black" points="637,-407.5 785,-407.5 "/>
<text text-anchor="start" x="667" y="-416.3" font-family="Times,serif" font-weight="bold" font-size="14.00">FaciesBase</text>
<polygon fill="#cccccc" stroke="transparent" points="637,-384.5 637,-407.5 684,-407.5 684,-384.5 637,-384.5"/>
<polyline fill="none" stroke="black" points="637,-384.5 684,-384.5 684,-407.5 637,-407.5 "/>
<text text-anchor="start" x="641" y="-392.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="684,-384.5 684,-407.5 738,-407.5 738,-384.5 684,-384.5"/>
<polygon fill="none" stroke="black" points="684,-384.5 684,-407.5 738,-407.5 738,-384.5 684,-384.5"/>
<text text-anchor="start" x="688" y="-392.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="738,-384.5 738,-407.5 785,-407.5 785,-384.5 738,-384.5"/>
<polyline fill="none" stroke="black" points="785,-407.5 738,-407.5 738,-384.5 785,-384.5 "/>
<text text-anchor="start" x="742" y="-392.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="684,-365.5 684,-384.5 "/>
<text text-anchor="start" x="641" y="-372.5" font-family="monospace" font-size="10.00">facies</text>
<polyline fill="none" stroke="black" points="738,-365.5 738,-384.5 "/>
<text text-anchor="start" x="688" y="-372.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="741" y="-372.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- FaciesBase&#45;&gt;ActiveLayer -->
<g id="edge4" class="edge">
<title>FaciesBase&#45;&gt;ActiveLayer</title>
<path fill="none" stroke="black" d="M658.11,-358.9C646.35,-351.71 633.61,-344.92 621,-340 535.64,-306.69 506.74,-326.82 418,-304 400.4,-299.47 381.99,-294 364.08,-288.26"/>
<polygon fill="black" stroke="black" points="364.77,-284.81 354.18,-285.04 362.61,-291.46 364.77,-284.81"/>
</g>
<!-- FaciesBase&#45;&gt;H5Writer -->
<g id="edge6" class="edge">
<title>FaciesBase&#45;&gt;H5Writer</title>
<path fill="none" stroke="black" d="M654.44,-358.84C643.57,-352.14 632.11,-345.56 621,-340 580.24,-319.62 562.92,-329.27 525,-304 511.79,-295.2 499.48,-282.59 489.96,-271.41"/>
<polygon fill="black" stroke="black" points="492.59,-269.11 483.54,-263.61 487.19,-273.56 492.59,-269.11"/>
</g>
<!-- FaciesBase&#45;&gt;Production -->
<g id="edge9" class="edge">
<title>FaciesBase&#45;&gt;Production</title>
<path fill="none" stroke="black" d="M700.18,-358.61C696.4,-344.99 692.02,-329.28 687.78,-314"/>
<polygon fill="black" stroke="black" points="691.06,-312.75 685.01,-304.05 684.32,-314.63 691.06,-312.75"/>
</g>
<!-- FaciesBase&#45;&gt;CellularAutomaton -->
<g id="edge18" class="edge">
<title>FaciesBase&#45;&gt;CellularAutomaton</title>
<path fill="none" stroke="black" d="M776.08,-358.81C806.31,-340.84 842.72,-319.19 875.49,-299.71"/>
<polygon fill="black" stroke="black" points="877.37,-302.67 884.17,-294.55 873.79,-296.65 877.37,-302.67"/>
</g>
<!-- SedimentBuffer&#45;&gt;ActiveLayer -->
<g id="edge5" class="edge">
<title>SedimentBuffer&#45;&gt;ActiveLayer</title>
<path fill="none" stroke="black" d="M185.68,-349.31C196.55,-331.67 208.83,-311.73 219.66,-294.14"/>
<polygon fill="black" stroke="black" points="222.91,-295.53 225.18,-285.18 216.95,-291.86 222.91,-295.53"/>
</g>
<!-- H5Writer&#45;&gt;ALCAP -->
<g id="edge14" class="edge">
<title>H5Writer&#45;&gt;ALCAP</title>
<path fill="none" stroke="black" d="M476.53,-227.18C489.02,-188.06 519.49,-92.64 534.44,-45.82"/>
<polygon fill="black" stroke="black" points="537.84,-46.66 537.55,-36.07 531.17,-44.53 537.84,-46.66"/>
</g>
<!-- CAProduction -->
<g id="node9" class="node">
<title>CAProduction</title>
<path fill="none" stroke="black" d="M691.5,-129.5C691.5,-129.5 592.5,-129.5 592.5,-129.5 586.5,-129.5 580.5,-123.5 580.5,-117.5 580.5,-117.5 580.5,-105.5 580.5,-105.5 580.5,-99.5 586.5,-93.5 592.5,-93.5 592.5,-93.5 691.5,-93.5 691.5,-93.5 697.5,-93.5 703.5,-99.5 703.5,-105.5 703.5,-105.5 703.5,-117.5 703.5,-117.5 703.5,-123.5 697.5,-129.5 691.5,-129.5"/>
<text text-anchor="start" x="587.5" y="-108.8" font-family="Times,serif" font-weight="bold" font-size="14.00">CAProduction</text>
</g>
<!-- Production&#45;&gt;CAProduction -->
<g id="edge12" class="edge">
<title>Production&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M657.24,-186.99C653.87,-170.54 650.36,-153.38 647.56,-139.68"/>
<polygon fill="black" stroke="black" points="650.91,-138.61 645.48,-129.52 644.06,-140.01 650.91,-138.61"/>
</g>
<!-- CAProduction&#45;&gt;ALCAP -->
<g id="edge15" class="edge">
<title>CAProduction&#45;&gt;ALCAP</title>
<path fill="none" stroke="black" d="M623.38,-93.29C608.03,-79.1 586.09,-58.82 569,-43.03"/>
<polygon fill="black" stroke="black" points="571.26,-40.35 561.54,-36.13 566.51,-45.49 571.26,-40.35"/>
</g>
<!-- CellularAutomaton&#45;&gt;CAProduction -->
<g id="edge11" class="edge">
<title>CellularAutomaton&#45;&gt;CAProduction</title>
<path fill="none" stroke="black" d="M839.42,-196.45C830.83,-193.23 822.29,-190.06 814,-187 769.29,-170.52 756.52,-170.42 713,-151 702.11,-146.14 690.61,-140.26 680.12,-134.57"/>
<polygon fill="black" stroke="black" points="681.64,-131.41 671.19,-129.65 678.26,-137.54 681.64,-131.41"/>
</g>
<!-- Tag -->
<g id="node11" class="node">
<title>Tag</title>
<path fill="none" stroke="black" d="M872,-151C872,-151 734,-151 734,-151 728,-151 722,-145 722,-139 722,-139 722,-84 722,-84 722,-78 728,-72 734,-72 734,-72 872,-72 872,-72 878,-72 884,-78 884,-84 884,-84 884,-139 884,-139 884,-145 878,-151 872,-151"/>
<polyline fill="none" stroke="black" points="729,-120.5 877,-120.5 "/>
<text text-anchor="start" x="789" y="-129.3" font-family="Times,serif" font-weight="bold" font-size="14.00">Tag</text>
<polygon fill="#cccccc" stroke="transparent" points="729,-97.5 729,-120.5 776,-120.5 776,-97.5 729,-97.5"/>
<polyline fill="none" stroke="black" points="729,-97.5 776,-97.5 776,-120.5 729,-120.5 "/>
<text text-anchor="start" x="733" y="-105.3" font-family="Times,serif" font-size="14.00">Input</text>
<polygon fill="#cccccc" stroke="transparent" points="776,-97.5 776,-120.5 830,-120.5 830,-97.5 776,-97.5"/>
<polygon fill="none" stroke="black" points="776,-97.5 776,-120.5 830,-120.5 830,-97.5 776,-97.5"/>
<text text-anchor="start" x="780" y="-105.3" font-family="Times,serif" font-size="14.00">Facies</text>
<polygon fill="#cccccc" stroke="transparent" points="830,-97.5 830,-120.5 877,-120.5 877,-97.5 830,-97.5"/>
<polyline fill="none" stroke="black" points="877,-120.5 830,-120.5 830,-97.5 877,-97.5 "/>
<text text-anchor="start" x="834" y="-105.3" font-family="Times,serif" font-size="14.00">State</text>
<polyline fill="none" stroke="black" points="776,-78.5 776,-97.5 "/>
<text text-anchor="start" x="733" y="-85.5" font-family="monospace" font-size="10.00">tag</text>
<polyline fill="none" stroke="black" points="830,-78.5 830,-97.5 "/>
<text text-anchor="start" x="780" y="-85.5" font-family="monospace" font-size="10.00"> </text>
<text text-anchor="start" x="833" y="-85.5" font-family="monospace" font-size="10.00"> </text>
</g>
<!-- Tag&#45;&gt;ALCAP -->
<g id="edge13" class="edge">
<title>Tag&#45;&gt;ALCAP</title>
<path fill="none" stroke="black" d="M721.71,-75.29C718.78,-74.16 715.87,-73.06 713,-72 670.5,-56.33 620.95,-41.23 586.35,-31.19"/>
<polygon fill="black" stroke="black" points="587.14,-27.77 576.56,-28.37 585.2,-34.5 587.14,-27.77"/>
</g>
</g>
</svg>
</div><div class="noweb-label">file:<i>src/Models/ALCAP/Example.jl</i></div><pre><code class="language- julia hljs">module Example

using Unitful
using ..ALCAP: ALCAP
using CarboKitten.Boxes: Box, Coast
using CarboKitten.Config: TimeProperties

&lt;&lt;alcap-example-input&gt;&gt;

end</code></pre><div class="noweb-label">file:<i>src/Models/ALCAP.jl</i></div><pre><code class="language- julia hljs">@compose module ALCAP
@mixin Tag, H5Writer, CAProduction, ActiveLayer

using ..Common
using ..CAProduction: production
using ..TimeIntegration
using ..WaterDepth
using ModuleMixins: @for_each
using .H5Writer: run_model

export Input, Facies

function initial_state(input::AbstractInput)
    ca_state = CellularAutomaton.initial_state(input)
    for _ in 1:20
        CellularAutomaton.step!(input)(ca_state)
    end

    sediment_height = zeros(Height, input.box.grid_size...)
    sediment_buffer = zeros(Float64, input.sediment_buffer_size, n_facies(input), input.box.grid_size...)

    return State(
        step=0, sediment_height=sediment_height,
        sediment_buffer=sediment_buffer,
        ca=ca_state.ca, ca_priority=ca_state.ca_priority)
end

function step!(input::AbstractInput)
    step_ca! = CellularAutomaton.step!(input)
    disintegrate! = disintegration(input)
    produce = production(input)
    transport = transportation(input)

    function (state::State)
        if mod(state.step, input.ca_interval) == 0
            step_ca!(state)
        end

        p = produce(state)
        d = disintegrate!(state)

        active_layer = p .+ d
        sediment = transport(state, active_layer)

        push_sediment!(state.sediment_buffer, sediment ./ input.depositional_resolution .|&gt; NoUnits)
        state.sediment_height .+= sum(sediment; dims=1)[1,:,:]
        state.step += 1

        return H5Writer.DataFrame(
            production = p,
            disintegration = d,
            deposition = sediment)
    end
end

function write_header(fid, input::AbstractInput)
    @for_each(P -&gt; P.write_header(fid, input), PARENTS)
end

include(&quot;ALCAP/Example.jl&quot;)

end</code></pre><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ca-with-production/">« Model with CA and Production</a><a class="docs-footer-nextpage" href="../first_tutorial/">Tutorial (Pluto notebook) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 24 March 2025 18:29">Monday 24 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
